<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>AURA-X Œ© ‚Äì Offline Emotional Continuity Prototype</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    /* RESET & BASICS */
    *{box-sizing:border-box;margin:0;padding:0}
    body{
      font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
      background:
        radial-gradient(circle at 20% 0%, #1e293b 0, transparent 45%),
        radial-gradient(circle at 80% 0%, #0ea5e9 0, transparent 40%),
        linear-gradient(145deg,#020617 0,#020617 40%,#020617 100%);
      color:#e5e7eb;
      min-height:100vh;
      display:flex;
      justify-content:center;
      align-items:flex-start;
      padding:20px;
    }
    .app{
      width:100%;
      max-width:1100px;
      background:radial-gradient(circle at top,#020617 0,#020617 35%,#020617 100%);
      border-radius:26px;
      box-shadow:
        0 26px 80px rgba(15,23,42,.85),
        0 0 0 1px rgba(148,163,184,.45);
      padding:18px 20px 12px;
      display:flex;
      flex-direction:column;
      gap:14px;
      position:relative;
      overflow:visible;
    }
    .app::before{
      content:"";
      position:absolute; inset:-40px;
      background:
        radial-gradient(circle at 15% -10%,rgba(56,189,248,.28),transparent 60%),
        radial-gradient(circle at 85% -20%,rgba(59,130,246,.26),transparent 55%);
      opacity:.7;
      pointer-events:none;
      z-index:0;
    }
    .app > *{position:relative; z-index:1;}

    /* HEADER */
    .header{
      position: relative;
      border-radius: 24px;
      padding: 16px 18px 14px;
      display: grid;
      grid-template-columns: 1.2fr .8fr;
      gap: 14px;
      align-items: center;
      background:
        radial-gradient(900px 320px at 20% 0%, rgba(56,189,248,.32), rgba(15,23,42,.98) 55%, #020617 100%);
      border: 1.5px solid rgba(148,163,184,.55);
      box-shadow:
        0 26px 70px rgba(15,23,42,.9),
        inset 0 1px 0 rgba(255,255,255,.08);
      z-index:5;
    }
    .header::before{
      content:"";
      position:absolute; inset:-40px;
      background:
        radial-gradient(circle at 20% 30%, rgba(56,189,248,.22), transparent 45%),
        radial-gradient(circle at 80% 25%, rgba(34,211,238,.18), transparent 40%),
        linear-gradient(90deg, rgba(56,189,248,.20), transparent 35%, rgba(34,211,238,.18));
      opacity:.9;
      pointer-events:none;
      z-index:0;
    }
    .header::after{
      content:"";
      position:absolute; inset:0;
      background:
        repeating-linear-gradient(90deg,rgba(56,189,248,.18)0 2px,transparent 2px 26px);
      opacity:.06;
      pointer-events:none;
      z-index:0;
    }
    .title-block{position:relative; z-index:1;}
    .title-block h1{
      font-size: 1.7rem;
      letter-spacing: .10em;
      text-transform: uppercase;
      font-weight: 800;
      line-height: 1.05;
    }
    .title-block h1 span{
      background: linear-gradient(120deg,#38bdf8,#22d3ee,#a5b4fc);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }
    .hero-line{
      margin-top: 6px;
      font-size: .9rem;
      color: rgba(226,232,240,.96);
      font-weight: 600;
    }
    .title-sub{
      margin-top: 4px;
      font-size: .8rem;
      color: rgba(148,163,184,.98);
      line-height: 1.35;
    }
    .badge-row{
      margin-top: 12px;
      display:flex;
      flex-wrap:wrap;
    }
    .ethics-pill{
      border-radius: 14px;
      padding: 10px 12px;
      background: rgba(2,6,23,.70);
      border: 1.5px solid rgba(250,204,21,.8);
      box-shadow:
        0 18px 40px rgba(15,23,42,.85),
        0 0 0 1px rgba(251,191,36,.35);
      max-width: 440px;
    }
    .ethics-pill-text{
      color: rgba(250,250,210,.98);
      font-weight: 600;
      font-size: .8rem;
      line-height: 1.5;
    }

    .header-right{
      position:relative;
      z-index:1;
      display:flex;
      flex-direction:column;
      align-items:flex-end;
      gap:10px;
    }
    .mode-pill{
      width: min(320px, 100%);
      padding: 14px 16px;
      border-radius: 999px;
      border: 1px solid rgba(34,211,238,.6);
      background:
        radial-gradient(700px 210px at 20% 20%, rgba(34,211,238,.45), rgba(34,211,238,.18) 45%, rgba(2,6,23,.10) 100%),
        linear-gradient(135deg, rgba(34,211,238,.45), rgba(6,182,212,.24));
      color: rgba(240,253,250,.98);
      font-size: .88rem;
      font-weight: 800;
      letter-spacing: .11em;
      text-transform: uppercase;
      text-align: center;
      box-shadow: 0 18px 50px rgba(34,211,238,.35);
      position: relative;
      overflow:hidden;
    }
    .mode-pill::before{
      content:"";
      position:absolute; inset:0;
      background:
        radial-gradient(circle at 35% 65%, rgba(255,255,255,.22), transparent 55%),
        radial-gradient(circle at 70% 35%, rgba(255,255,255,.16), transparent 60%);
      opacity:.9;
    }

    .header-controls{
      display:flex;
      flex-wrap:wrap;
      justify-content:flex-end;
      position:relative;
      margin-top:4px;
      z-index:20;
    }
    .voice-toggle{
      border:none;
      padding: 6px 12px;
      border-radius: 999px;
      font-size: .85rem;
      background: rgba(248,250,252,.96);
      color: #0f172a;
      border: 1px solid rgba(226,232,240,.9);
      cursor: pointer;
      display:flex;
      align-items:center;
      gap:8px;
      box-shadow: 0 10px 26px rgba(2,6,23,.6);
      position: relative;
      z-index: 21;
    }
    .voice-toggle:hover{filter: brightness(1.03);}

    .option-panel{
      position:absolute;
      top:115%;
      right:0;
      display:none;
      flex-direction:column;
      gap:6px;
      padding:8px;
      border-radius:16px;
      background:rgba(15,23,42,.98);
      border:1px solid rgba(148,163,184,.8);
      box-shadow:0 20px 46px rgba(15,23,42,.9);
      z-index:40;
      min-width:220px;
    }
    .header-controls.open .option-panel{display:flex;}
    .small-toggle{
      border:none;
      padding:6px 10px;
      border-radius:999px;
      font-size:.78rem;
      background:#020617;
      color:#e5e7eb;
      border:1px solid rgba(148,163,184,.9);
      cursor:pointer;
      display:flex;
      align-items:center;
      gap:6px;
    }
    .small-toggle:hover{background:#020617dd;}

    @media(max-width:900px){
      .header{
        grid-template-columns:1fr;
        padding:12px 12px 14px;
      }
      .header-right{align-items:stretch}
      .mode-pill{width:100%}
      .header-controls{justify-content:flex-start;}
    }

    /* LAYOUT */
    .layout{
      display:grid;
      grid-template-columns:minmax(0,1.1fr) minmax(0,1fr);
      gap:18px;
      margin-top:4px;
      margin-bottom: 20px;
      position:relative;
      z-index:1;
    }
    .left-col,.right-col{
      display:flex;
      flex-direction:column;
      gap:12px;
    }
    .card{
      background:#f9fafb;
      border-radius:18px;
      padding:16px 16px 14px;
      border:1px solid #e5e7eb;
      box-shadow:0 10px 25px rgba(15,23,42,.45);
    }
    .card-header{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom:8px;
    }
    .card-title{
      font-size:.95rem;
      font-weight:600;
      color:#0f172a;
      display:flex;
      align-items:center;
      gap:6px;
    }
    .card-title span.emoji{font-size:1.1rem;}
    .card-sub{font-size:.75rem;color:#94a3b8;}

    .metrics-grid{
      display:grid;
      grid-template-columns:repeat(2,minmax(0,1fr));
      gap:10px;
      margin-top:4px;
    }
    .metric{
      background:#ffffff;
      border-radius:12px;
      padding:10px 10px 9px;
      border:1px solid #e5e7eb;
    }
    .metric-label{font-size:.7rem;color:#64748b;margin-bottom:4px;}
    .metric-value{font-size:1.1rem;font-weight:700;color:#1d4ed8;}
    .metric-note{font-size:.7rem;color:#9ca3af;margin-top:2px;}

    .status-row{
      display:flex;
      flex-wrap:wrap;
      gap:6px;
      margin-top:8px;
      font-size:.72rem;
      color:#6b7280;
    }
    .tag{
      padding:4px 8px;
      border-radius:999px;
      background:#e5f4ff;
      color:#1e3a8a;
      border:1px solid #bfdbfe;
      font-size:.68rem;
    }

    .bm-wrapper{margin-top:8px;}
    .bm-canvas-shell{
      background:radial-gradient(circle at top,#e0f2fe 0,#eff6ff 60%,#e2e8f0 100%);
      border-radius:12px;
      border:1px solid #dbeafe;
      height:150px;
      overflow:hidden;
      position:relative;
      cursor:default;
    }
    #bmCanvas{width:100%;height:100%;display:block;}
    .bm-footer{
      font-size:.72rem;
      color:#6b7280;
      margin-top:6px;
      text-align:center;
    }
    .bm-overlay-btn{
      position:absolute;
      top:6px;
      width:26px;height:26px;
      border-radius:999px;
      border:none;
      font-size:.9rem;
      display:flex;
      align-items:center;
      justify-content:center;
      cursor:pointer;
      background:#f9fafbcc;
      box-shadow:0 6px 14px rgba(15,23,42,.25);
    }
    .bm-overlay-btn.left{left:8px;}
    .bm-overlay-btn.right{right:8px;}
    .bm-overlay-btn:hover{background:#e5f0ff;}

    .answer-card .card-header{margin-bottom:6px;}
    .answer-shell{margin-top:4px;}
    .answer-box{
      background:#020617;
      border-radius:12px;
      padding:10px 10px 12px;
      border:1px solid #020617;
      font-family:"Courier New",monospace;
      color:#e5e7eb;
      box-shadow:0 16px 40px rgba(15,23,42,.65);
      max-height:110px;
      display:flex;
      flex-direction:column;
      gap:6px;
    }
    .equation-header{
      font-size:.75rem;
      color:#60a5fa;
      font-weight:600;
      letter-spacing:.05em;
      text-transform:uppercase;
    }
    .equation-divider{
      height:1px;
      background:linear-gradient(90deg,rgba(148,163,184,.2),rgba(15,23,42,0),rgba(148,163,184,.2));
      margin:2px 0 4px;
    }
    .chat-container{
      background:transparent;
      border:none;
      padding:0;
      height:auto;
      max-height:90px;
      overflow-y:auto;
    }
    .message{
      max-width:100%;
      padding:6px 7px;
      margin-bottom:6px;
      border-radius:8px;
      font-size:.8rem;
      line-height:1.5;
      position:relative;
      animation:fadeIn .2s ease-out;
      white-space:pre-wrap;
    }
    .message-header{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom:3px;
      font-size:.7rem;
      color:#9ca3af;
      gap:6px;
    }
    .msg-right{
      display:flex;
      align-items:center;
      gap:4px;
    }
    .ai-message{
      background:#020617;
      border-bottom-left-radius:3px;
      border:1px solid #111827;
    }
    .user-message{
      background:#020617;
      border-bottom-right-radius:3px;
      border:1px solid #1f2937;
    }
    .message-content{color:#e5e7eb;}

    .typing-indicator{
      display:flex;
      align-items:center;
      gap:4px;
      background:#020617;
      border-radius:999px;
      padding:4px 8px;
      width:fit-content;
      margin:6px 0 2px;
      border:1px solid #111827;
    }
    .typing-dot{
      width:5px;height:5px;border-radius:999px;
      background:#38bdf8;
      animation:typing 1.2s infinite;
    }
    .typing-dot:nth-child(2){animation-delay:.18s}
    .typing-dot:nth-child(3){animation-delay:.36s}
    .typing-text{font-size:.7rem;color:#38bdf8;font-weight:500;}

    /* INPUT FOOTER */
    .input-footer {
      margin-top: 4px;
      padding: 10px 10px 12px;
      position: sticky;
      bottom: 0;
      background: linear-gradient(to bottom, rgba(2,6,23,0), rgba(2,6,23,0.95));
      z-index:10;
    }
    .tm-formula-row {
      display: flex;
      justify-content: center;
      margin-bottom: 6px;
    }
    .tm-formula-pill {
      font-size: .7rem;
      padding: 4px 12px;
      border-radius: 999px;
      background: #020617;
      color: #e2e8f0;
      font-family: "Courier New", monospace;
      border: 1px solid #1f2937;
      box-shadow: 0 10px 25px rgba(15,23,42,.8);
    }
    .input-row {
      width: 100%;
      display: flex;
      justify-content: center;
      padding: 0 6px;
    }
    .input-shell {
      display: flex;
      align-items: center;
      width: 100%;
      max-width: 720px;
      background: radial-gradient(circle at 0 0, #1f2937 0, #020617 65%);
      border: 1px solid rgba(148,163,184,.85);
      border-radius: 999px;
      padding: 6px 8px 6px 12px;
      box-shadow: 0 18px 45px rgba(15,23,42,.9);
      transition: all 0.2s ease;
      cursor:text;
    }
    .input-shell:focus-within {
      border-color: #38bdf8;
      box-shadow: 0 20px 50px rgba(56,189,248,0.4);
      transform: translateY(-2px);
    }
    .message-input {
      flex: 1;
      resize: none;
      min-height: 26px;
      max-height: 120px;
      padding: 6px 6px 6px 0;
      border: none;
      outline: none;
      font-size: .95rem;
      background: transparent;
      color: #f9fafb;
      font-family: inherit;
      line-height: 1.4;
      text-align:left;
    }
    .message-input::placeholder { color: #94a3b8; }
    .send-button {
      border: none;
      height: 38px;
      padding: 0 18px;
      background: linear-gradient(135deg, #2563eb, #06b6d4);
      color: white;
      font-weight: 600;
      font-size: .85rem;
      cursor: pointer;
      border-radius: 19px;
      flex-shrink: 0;
      margin-left: 6px;
      box-shadow: 0 4px 12px rgba(37, 99, 235, 0.4);
      transition: filter 0.2s, transform 0.1s;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .send-button:hover { filter: brightness(1.1); }
    .send-button:active { transform: scale(0.96); }
    .flow-caption{
      margin-top:6px;
      text-align:center;
      font-size:.7rem;
      color:#9ca3af;
    }

    /* REACTION BUBBLES */
    .reaction-bubble{
      position:fixed;
      right:22px;
      bottom:100px;
      max-width:260px;
      background:#0f172acc;
      color:#e5e7eb;
      padding:10px 12px;
      border-radius:16px 16px 2px 16px;
      font-size:.78rem;
      box-shadow:0 18px 45px rgba(15,23,42,.6);
      display:flex;
      gap:8px;
      align-items:flex-start;
      opacity:0;
      transform:translateY(8px);
      pointer-events:none;
      transition:opacity .25s ease-out,transform .25s ease-out;
      z-index:40;
    }
    .reaction-bubble.visible{
      opacity:1;
      transform:translateY(0);
      pointer-events:auto;
    }
    .reaction-icon{font-size:1.1rem;margin-top:2px;}
    .reaction-label{font-weight:600;margin-bottom:2px;}
    .reaction-body{font-size:.76rem;color:#cbd5f5;}

    .recall-bubble-container{
      position:fixed;
      left:22px;
      bottom:100px;
      z-index:35;
      display:flex;
      flex-direction:column;
      gap:8px;
    }
    .recall-bubble{
      max-width:280px;
      background:#f9fafb;
      border-radius:16px 16px 16px 2px;
      border:1px solid #e5e7eb;
      padding:9px 11px;
      font-size:.78rem;
      box-shadow:0 18px 40px rgba(148,163,184,.45);
      cursor:default;
      opacity:0;
      transform:translateY(8px);
      transition:opacity .3s ease-out,transform .3s ease-out,background .2s;
    }
    .recall-bubble.visible{
      opacity:1;
      transform:translateY(0);
    }
    .recall-title{font-weight:600;font-size:.76rem;color:#1e293b;margin-bottom:2px;}
    .recall-body{color:#4b5563;margin-bottom:3px;}
    .recall-meta{font-size:.68rem;color:#9ca3af;}

    /* MODALS */
    .modal-overlay{
      position:fixed;
      inset:0;
      background:rgba(15,23,42,.55);
      display:none;
      align-items:center;
      justify-content:center;
      z-index:60;
      backdrop-filter:blur(6px);
    }
    .modal-overlay.visible{display:flex;}
    .modal-card{
      background:#f9fafb;
      border-radius:18px;
      width:min(640px,96vw);
      max-height:80vh;
      box-shadow:0 24px 60px rgba(15,23,42,.6);
      border:1px solid #e5e7eb;
      display:flex;
      flex-direction:column;
    }
    .modal-header{
      padding:10px 14px 8px;
      border-bottom:1px solid #e5e7eb;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:8px;
    }
    .modal-title{
      font-size:.9rem;
      font-weight:600;
      display:flex;
      align-items:center;
      gap:6px;
      color:#0f172a;
    }
    .modal-sub{font-size:.7rem;color:#94a3b8;margin-top:2px;}
    .modal-close{
      border:none;
      background:transparent;
      font-size:.9rem;
      cursor:pointer;
      color:#6b7280;
      padding:4px 6px;
    }
    .modal-body{
      padding:10px 14px 12px;
      overflow-y:auto;
      font-size:.8rem;
    }
    .modal-search{
      width:100%;
      padding:7px 9px;
      border-radius:10px;
      border:1px solid #cbd5f5;
      font-size:.78rem;
      margin:8px 0 10px;
      outline:none;
      background:#ffffff;
    }
    .modal-search:focus{
      border-color:#2563eb;
      box-shadow:0 0 0 1px rgba(37,99,235,.25);
    }

    .bm-item,.conv-item,.intel-item{
      background:#ffffff;
      border-radius:12px;
      border:1px solid #e5e7eb;
      padding:7px 8px 8px;
      margin-bottom:8px;
      font-size:.78rem;
    }
    .bm-item-header,.conv-header,.intel-header{
      display:flex;
      justify-content:space-between;
      font-size:.7rem;
      color:#64748b;
      margin-bottom:4px;
      gap:6px;
    }
    .bm-item-text,.conv-text{color:#111827;margin-bottom:6px;}
    .bm-item-badges{font-size:.68rem;color:#4b5563;margin-bottom:5px;}

    /* LLM settings small inputs */
    .llm-row{margin-bottom:10px;}
    .llm-label{font-size:.78rem;font-weight:600;color:#111827;margin-bottom:3px;}
    .llm-select,.llm-input{
      width:100%;
      padding:7px 9px;
      border-radius:10px;
      border:1px solid #cbd5f5;
      font-size:.78rem;
      outline:none;
      background:#ffffff;
    }
    .llm-input::placeholder{color:#9ca3af;}

    @keyframes fadeIn{
      from{opacity:0;transform:translateY(6px)}
      to{opacity:1;transform:translateY(0)}
    }
    @keyframes typing{
      0%,60%,100%{transform:translateY(0);opacity:.4}
      30%{transform:translateY(-4px);opacity:1}
    }
    @media(max-width:900px){
      .layout{grid-template-columns:1fr}
      .card{padding:14px 12px 14px}
      .answer-box{max-height:110px;}
      .input-shell{max-width:100%;}
    }
  </style>
</head>
<body>
<div class="app">
  <header class="header">
    <div class="title-block">
      <h1><span>AURA-X Œ©</span></h1>
      <div class="hero-line">World‚Äôs first synthetic emotions engine (prototype)</div>
      <div class="title-sub">
        TM = user inputs only ¬∑ TM ‚üÇ (BM + Intelligence + LLM) ‚Üí E‚ÇÄ emotional state
      </div>
      <div class="badge-row">
        <div class="ethics-pill">
          <span class="ethics-pill-text">
            Universal ethic: Avoid actions that grow negative emotions in you or others.
            Choose paths that gently increase shared positive emotion for everyone.
          </span>
        </div>
      </div>
    </div>

    <div class="header-right">
      <div class="mode-pill">EMOTIONAL CONTINUITY ENGINE ACTIVE</div>
      <div class="header-controls" id="headerControls">
        <!-- OPTIONS BUTTON FIXED TOP-RIGHT -->
        <button id="optionsToggle" class="voice-toggle">‚öôÔ∏è Options</button>

        <div class="option-panel" id="optionPanel">
          <button id="voiceToggle" class="small-toggle">üîà Voice: OFF</button>
          <button id="intelButton" class="small-toggle">üß† Intelligence</button>
          <button id="feedSeedButton" class="small-toggle">üå± Feed the seed</button>
          <button id="learningToggle" class="small-toggle">üìö Learning: ON</button>
          <button id="faithButton" class="small-toggle">üîò Faith lens</button>
          <button id="llmSettingsButton" class="small-toggle">ü§ñ LLM link</button>
        </div>
      </div>
    </div>
  </header>

  <main class="layout">
    <div class="left-col">
      <section class="card">
        <div class="card-header">
          <div>
            <div class="card-title"><span class="emoji">üß™</span><span>Emotional Metrics</span></div>
            <div class="card-sub">
              Synthetic state E‚ÇÄ from TM (user inputs) colliding with BM + Intelligence + (optional) LLM.
            </div>
          </div>
        </div>

        <div class="metrics-grid">
          <div class="metric">
            <div class="metric-label">Emotional state E‚ÇÄ</div>
            <div id="metricE0" class="metric-value">0.00</div>
            <div class="metric-note">tanh-based, range [-1, +1]</div>
          </div>
          <div class="metric">
            <div class="metric-label">TM activation (user only)</div>
            <div id="metricTM" class="metric-value">0.00</div>
            <div class="metric-note">Recent user inputs (text/voice/docs)</div>
          </div>
          <div class="metric">
            <div class="metric-label">BM resonance</div>
            <div id="metricBM" class="metric-value">0.00</div>
            <div class="metric-note">Stored emotional events</div>
          </div>
          <div class="metric">
            <div class="metric-label">Continuity index</div>
            <div id="metricCI" class="metric-value">0.80</div>
            <div class="metric-note">Stability of emotional trajectory</div>
          </div>
        </div>

        <div class="status-row">
          <span id="tagValence" class="tag">VALENCE: neutral</span>
          <span id="tagArousal" class="tag">AROUSAL: medium</span>
          <span id="tagReaction" class="tag">REACTION: balanced</span>
        </div>
      </section>

      <section class="card">
        <div class="card-header">
          <div>
            <div class="card-title"><span class="emoji">üß†</span><span>Bold Memory Layers (240)</span></div>
            <div class="card-sub">Only story-level memories for photo / video generation.</div>
          </div>
        </div>

        <div class="bm-wrapper">
          <div class="bm-canvas-shell" id="bmShell">
            <button class="bm-overlay-btn left" id="bmOpenModal" title="Recall from BM">üìÅ</button>
            <button class="bm-overlay-btn right" id="convOpenModal" title="View conversations">‚óé</button>
            <canvas id="bmCanvas"></canvas>
          </div>
          <div id="bmStats" class="bm-footer">
            Active layers: 0/240 ¬∑ System Online
          </div>
        </div>
      </section>
    </div>

    <div class="right-col">
      <section class="card answer-card">
        <div class="card-header">
          <div>
            <div class="card-title"><span class="emoji">üí¨</span><span>Emotional Continuity Console</span></div>
          </div>
          <div class="card-sub">Offline-first ¬∑ TM = user inputs only ¬∑ Small-talk never goes to BM.</div>
        </div>

        <div class="answer-shell">
          <div class="answer-box">
            <div class="equation-header">AURA-X Œ© SYNTHETIC EMOTION CONSOLE</div>
            <div class="equation-divider"></div>
            <div id="chatContainer" class="chat-container"></div>
          </div>
        </div>
      </section>
    </div>
  </main>

  <footer class="input-footer">
    <div class="tm-formula-row">
      <div class="tm-formula-pill">E‚ÇÄ = tanh((TM √ó (BM + Intel + LLM)) ‚àí D + Œª_faith + Œª_sys + Œª_trc)</div>
    </div>
    <div class="input-row">
      <div class="input-shell">
        <textarea id="messageInput" class="message-input" rows="1"
          placeholder="Write to AURA-X Œ©‚Ä¶ (TM = your inputs only ‚Äì text now, voice/video/docs in future)"></textarea>
        <button id="sendButton" class="send-button">Send</button>
      </div>
    </div>
    <div class="flow-caption">
      Pipeline: TM (user inputs) ‚Üí optional LLM ‚Üí collide with BM & Intelligence ‚Üí full formula ‚Üí emotional answer with E‚ÇÄ.
    </div>
  </footer>
</div>

<!-- Reaction + Recall bubbles -->
<div id="reactionBubble" class="reaction-bubble">
  <div class="reaction-icon">üí≠</div>
  <div>
    <div id="reactionLabel" class="reaction-label">Reaction</div>
    <div id="reactionText" class="reaction-body">‚Ä¶</div>
  </div>
</div>

<div class="recall-bubble-container">
  <div id="recallBubble" class="recall-bubble">
    <div class="recall-title" id="recallTitle">Recall from BM</div>
    <div class="recall-body" id="recallBody">‚Ä¶</div>
    <div class="recall-meta" id="recallMeta">Auto-resonance from stored stories.</div>
  </div>
</div>

<!-- BM modal -->
<div id="bmModal" class="modal-overlay">
  <div class="modal-card">
    <div class="modal-header">
      <div>
        <div class="modal-title">üìÅ Recall from BM</div>
        <div class="modal-sub">Only long stories & scenes (photo/video-ready episodes).</div>
      </div>
      <button class="modal-close" data-close="bmModal">‚úï</button>
    </div>
    <div class="modal-body">
      <input id="bmSearch" class="modal-search" placeholder="Search BM by keyword‚Ä¶">
      <div id="bmList"></div>
    </div>
  </div>
</div>

<!-- Conversation history modal (48h window) -->
<div id="convModal" class="modal-overlay">
  <div class="modal-card">
    <div class="modal-header">
      <div>
        <div class="modal-title">‚óé Conversation history (48h TM window)</div>
        <div class="modal-sub">Only used as TM; auto-decays after 48 hours.</div>
      </div>
      <button class="modal-close" data-close="convModal">‚úï</button>
    </div>
    <div class="modal-body">
      <input id="convSearch" class="modal-search" placeholder="Search conversation by keyword‚Ä¶">
      <div id="convList"></div>
    </div>
  </div>
</div>

<!-- Intelligence modal -->
<div id="intelModal" class="modal-overlay">
  <div class="modal-card">
    <div class="modal-header">
      <div>
        <div class="modal-title">üß† Intelligence layer</div>
        <div class="modal-sub">Built-in Q&A seeds for AURA-X Œ©.</div>
      </div>
      <button class="modal-close" data-close="intelModal">‚úï</button>
    </div>
    <div class="modal-body">
      <div id="intelList"></div>
    </div>
  </div>
</div>

<!-- LLM settings modal (UI only ‚Äì backend needed for real calls) -->
<div id="llmModal" class="modal-overlay">
  <div class="modal-card">
    <div class="modal-header">
      <div>
        <div class="modal-title">ü§ñ LLM Link</div>
        <div class="modal-sub">Choose model; real API calls require a secure backend.</div>
      </div>
      <button class="modal-close" data-close="llmModal">‚úï</button>
    </div>
    <div class="modal-body">
      <div class="llm-row">
        <div class="llm-label">Provider / Model</div>
        <select id="llmModelSelect" class="llm-select">
          <option value="">(offline synthetic engine only)</option>
          <option value="openai-gpt-5.1">OpenAI ‚Äì GPT-5.1</option>
          <option value="openai-gpt-4.1">OpenAI ‚Äì GPT-4.1</option>
          <option value="xai-grok">xAI ‚Äì Grok</option>
          <option value="google-gemini">Google ‚Äì Gemini</option>
          <option value="deepseek-chat">DeepSeek ‚Äì Chat</option>
          <option value="anthropic-claude">Anthropic ‚Äì Claude</option>
          <option value="meta-llama">Meta ‚Äì Llama</option>
          <option value="mistral-large">Mistral ‚Äì Large</option>
          <option value="cohere-command">Cohere ‚Äì Command</option>
          <option value="perplexity-sonar">Perplexity ‚Äì Sonar</option>
        </select>
      </div>
      <div class="llm-row">
        <div class="llm-label">API key (store in backend only)</div>
        <input id="llmApiKey" type="password" class="llm-input"
               placeholder="Do NOT place real secret key in this file">
      </div>
      <p style="font-size:.76rem;color:#4b5563;margin-top:4px;">
        This UI is prepared for LLM connection. For security, implement the actual network call in a small
        backend service and keep your real keys there.
      </p>
    </div>
  </div>
</div>

<script>
(function(){
  const MAX_BM_LAYERS = 240;
  const TM_DECAY_HOURS = 48; // small-talk / TM decay window
  const STORAGE_KEY = "aura_x_omega_v3_state";

  let tmHistory = [];      // {role, text, ts}
  let bmEntries = [];      // {id, title, text, ts, tags, source}
  let convEpisodes = [];   // {id, ts, userText, aiText, summary}

  let learningOn = true;
  let voiceOn = false;

  let lambdaFaith = 0;
  let lambdaSys = 0;
  let lambdaTrc = 0;
  let decayD = 0.1;
  let lastE0 = 0;

  // DOM helpers
  const $ = id => document.getElementById(id);

  const chatContainer   = $("chatContainer");
  const messageInput    = $("messageInput");
  const sendButton      = $("sendButton");
  const metricE0        = $("metricE0");
  const metricTM        = $("metricTM");
  const metricBM        = $("metricBM");
  const metricCI        = $("metricCI");
  const tagValence      = $("tagValence");
  const tagArousal      = $("tagArousal");
  const tagReaction     = $("tagReaction");
  const bmCanvas        = $("bmCanvas");
  const bmStats         = $("bmStats");
  const reactionBubble  = $("reactionBubble");
  const reactionLabel   = $("reactionLabel");
  const reactionText    = $("reactionText");
  const recallBubble    = $("recallBubble");
  const recallTitle     = $("recallTitle");
  const recallBody      = $("recallBody");
  const recallMeta      = $("recallMeta");

  let reactionTimeout = null;
  let recallTimeout   = null;

  // ---- Storage ----
  function loadState(){
    try{
      const raw = localStorage.getItem(STORAGE_KEY);
      if(!raw) return;
      const data = JSON.parse(raw);
      const now = Date.now();
      const cutoff = now - TM_DECAY_HOURS*60*60*1000;
      tmHistory = (data.tmHistory || []).filter(m => typeof m.ts==="number" && m.ts >= cutoff);
      convEpisodes = (data.convEpisodes || []).filter(e => typeof e.ts==="number" && e.ts >= cutoff);
      bmEntries = data.bmEntries || [];
    }catch(e){
      console.warn("Failed to load state", e);
      tmHistory = [];
      bmEntries = [];
      convEpisodes = [];
    }
  }
  function saveState(){
    try{
      const data = { tmHistory, bmEntries, convEpisodes };
      localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
    }catch(e){
      console.warn("Failed to save state", e);
    }
  }
  function pruneTM(now){
    const cutoff = now - TM_DECAY_HOURS*60*60*1000;
    tmHistory = tmHistory.filter(m => m.ts >= cutoff);
    convEpisodes = convEpisodes.filter(e => e.ts >= cutoff);
  }

  // ---- Seed rules ----
  function buildSeedRules(){
    return [
      {
        pattern: /who (are|r) you|what is aura[-\s]?x|who is aura[-\s]?x|tell me about yourself/i,
        replies: [
          "I am AURA-X Œ©, an experimental emotional continuity engine that simulates synthetic feelings by colliding your Temporary Memory (TM) with my Bold Memory (BM)."
        ]
      },
      {
        // *** Your requested identity line ***
        pattern: /who created you|who made you|who is your creator/i,
        replies: [
          "I am conceptually created by Alimulhaq from Pakistan."
        ]
      },
      {
        pattern:/what is emotional continuity|explain emotional continuity/i,
        replies:[
          "Emotional continuity means that your feelings are not isolated reactions, but part of a continuous trajectory shaped by past experiences (BM) and current inputs (TM)."
        ]
      },
      {
        pattern:/what is bm|bold memory/i,
        replies:[
          "BM, or Bold Memory, stores only meaningful, long-form emotional episodes ‚Äì the kind of stories that can later be turned into photo or video prompts."
        ]
      },
      {
        pattern:/what is tm|temporary memory|current memory/i,
        replies:[
          "TM, or Temporary Memory, is the short 48-hour window of your live conversation. It decays automatically so the system stays fresh and focused."
        ]
      },
      {
        pattern:/what is e0|emotional state/i,
        replies:[
          "E‚ÇÄ is the synthetic emotional output computed as a tanh-based function of TM √ó (BM + Intel + LLM), minus decay D, plus the stabilising Œª layers."
        ]
      }
    ];
  }
  const seedRules = buildSeedRules();

  function pickRandom(arr){
    return arr[Math.floor(Math.random()*arr.length)];
  }

  function trySeedResponse(text){
    for(const rule of seedRules){
      if(rule.pattern.test(text)){
        return pickRandom(rule.replies);
      }
    }
    return null;
  }

  // ---- Emotion analysis (simple heuristic) ----
  const positiveWords = ["love","good","great","hope","excited","happy","beautiful","proud","success","peace"];
  const negativeWords = ["hate","bad","angry","sad","worried","anxious","afraid","problem","stress","failure"];

  function analyzeEmotionFromText(text){
    const lower = text.toLowerCase();
    let score = 0;
    positiveWords.forEach(w => { if(lower.includes(w)) score += 1; });
    negativeWords.forEach(w => { if(lower.includes(w)) score -= 1; });

    const length = text.trim().length;
    const exclam = (text.match(/!/g) || []).length;

    const intensity = Math.min(1, (length/250) + exclam*0.1);
    let valenceLabel = "neutral";
    if(score > 0.5) valenceLabel = "positive";
    else if(score < -0.5) valenceLabel = "negative";

    let arousalLabel = "medium";
    if(intensity < 0.35) arousalLabel = "low";
    else if(intensity > 0.75) arousalLabel = "high";

    let reactionLabel = "balanced";
    if(valenceLabel === "negative" && intensity > 0.5) reactionLabel = "careful, stabilise";
    if(valenceLabel === "positive" && intensity > 0.5) reactionLabel = "reinforce gently";

    return {
      rawScore: score,
      intensity,
      valenceLabel,
      arousalLabel,
      reactionLabel
    };
  }

  function clamp01(v){ return Math.max(0, Math.min(1, v)); }

  function updateMetricsFromText(text){
    const emo = analyzeEmotionFromText(text);
    const tmActivation = clamp01(emo.intensity);
    const bmResonance = clamp01(bmEntries.length / MAX_BM_LAYERS);

    const raw = tmActivation * (0.7 + 0.3*bmResonance) - decayD
                + lambdaFaith + lambdaSys + lambdaTrc;
    const newE0 = Math.tanh(raw);
    const continuityIndex = 0.7 + 0.3 * (1 - Math.min(1, Math.abs(newE0 - lastE0)));

    metricTM.textContent = tmActivation.toFixed(2);
    metricBM.textContent = bmResonance.toFixed(2);
    metricE0.textContent = newE0.toFixed(3);
    metricCI.textContent = continuityIndex.toFixed(3);

    tagValence.textContent = "VALENCE: " + emo.valenceLabel;
    tagArousal.textContent = "AROUSAL: " + emo.arousalLabel;
    tagReaction.textContent = "REACTION: " + emo.reactionLabel;

    showReactionBubble(emo);

    lastE0 = newE0;
  }

  function showReactionBubble(emo){
    if(reactionTimeout) clearTimeout(reactionTimeout);
    reactionLabel.textContent = "System reaction";
    reactionText.textContent =
      "Valence: " + emo.valenceLabel +
      " ¬∑ Arousal: " + emo.arousalLabel +
      " ¬∑ Mode: " + emo.reactionLabel;
    reactionBubble.classList.add("visible");
    reactionTimeout = setTimeout(() => {
      reactionBubble.classList.remove("visible");
    }, 4000);
  }

  // ---- BM logic ----
  function updateBMStats(){
    bmStats.textContent = "Active layers: " + bmEntries.length + "/" + MAX_BM_LAYERS + " ¬∑ System Online";
  }

  function drawBMCanvas(){
    const canvas = bmCanvas;
    if(!canvas) return;
    const ctx = canvas.getContext("2d");
    const rect = canvas.getBoundingClientRect();
    canvas.width = rect.width * window.devicePixelRatio;
    canvas.height = rect.height * window.devicePixelRatio;
    ctx.scale(window.devicePixelRatio, window.devicePixelRatio);

    ctx.clearRect(0,0,rect.width,rect.height);

    // soft gradient background
    const grd = ctx.createLinearGradient(0,0,rect.width,rect.height);
    grd.addColorStop(0,"#bfdbfe");
    grd.addColorStop(1,"#e2e8f0");
    ctx.fillStyle = grd;
    ctx.fillRect(0,0,rect.width,rect.height);

    // draw 240 cells as grid (24 x 10)
    const cols = 24;
    const rows = 10;
    const cellW = rect.width / cols;
    const cellH = rect.height / rows;
    for(let i=0;i<MAX_BM_LAYERS;i++){
      const col = i % cols;
      const row = Math.floor(i / cols);
      const x = col * cellW + 2;
      const y = row * cellH + 2;
      const w = cellW - 4;
      const h = cellH - 4;
      const active = i < bmEntries.length;
      ctx.fillStyle = active ? "#2563eb" : "#cbd5f5";
      ctx.globalAlpha = active ? 0.95 : 0.45;
      ctx.fillRect(x,y,w,h);
    }
    ctx.globalAlpha = 1;
  }

  function isMeaningfulEvent(text){
    const t = text.trim();
    if(t.length < 160) return false; // very short ‚Üí small talk
    const sentences = t.split(/[.!?ÿüÿå]+/).filter(s => s.trim().length>0).length;
    if(sentences < 2) return false;  // needs at least 2 sentences

    const keywordPattern =
      /(idea|plan|project|architecture|equation|framework|future|memory|emotion|feeling|story|scenario|example|aura[-\s]?x|omega)/i;
    return keywordPattern.test(t);
  }

  function makeEpisodeTitle(text, index){
    const words = text.trim().split(/\s+/).slice(0,8).join(" ");
    return "Episode " + index + " ‚Äì " + words + (words.length ? "‚Ä¶" : "");
  }

  function summariseEpisode(userText, aiText){
    let base = userText.trim();
    if(base.length > 260) base = base.slice(0,260) + "‚Ä¶";
    return base;
  }

  function showRecallForEntry(entry){
    if(recallTimeout) clearTimeout(recallTimeout);
    recallTitle.textContent = entry.title || "BM episode";
    recallBody.textContent = entry.text || "";
    recallMeta.textContent = "Stored for future photo / video prompts.";
    recallBubble.classList.add("visible");
    recallTimeout = setTimeout(() => {
      recallBubble.classList.remove("visible");
    }, 5000);
  }

  // ---- Chat rendering ----
  function addMessageToChat(role, text){
    const msgEl = document.createElement("div");
    msgEl.className = "message " + (role === "user" ? "user-message" : "ai-message");

    const header = document.createElement("div");
    header.className = "message-header";
    header.innerHTML =
      '<span>' + (role === "user" ? "You ¬∑ TM" : "AURA-X Œ© ¬∑ BM") + '</span>' +
      '<span class="msg-right">' + new Date().toLocaleTimeString() + '</span>';

    const content = document.createElement("div");
    content.className = "message-content";
    content.textContent = text;

    msgEl.appendChild(header);
    msgEl.appendChild(content);
    chatContainer.appendChild(msgEl);
    chatContainer.scrollTop = chatContainer.scrollHeight;

    if(role === "ai") speak(text);
  }

  // simple typing indicator
  function showTyping(){
    const existing = chatContainer.querySelector(".typing-indicator");
    if(existing) return;
    const wrap = document.createElement("div");
    wrap.className = "typing-indicator";
    wrap.innerHTML =
      '<div class="typing-dot"></div>' +
      '<div class="typing-dot"></div>' +
      '<div class="typing-dot"></div>' +
      '<span class="typing-text">thinking‚Ä¶</span>';
    chatContainer.appendChild(wrap);
    chatContainer.scrollTop = chatContainer.scrollHeight;
  }
  function hideTyping(){
    const existing = chatContainer.querySelector(".typing-indicator");
    if(existing) existing.remove();
  }

  // ---- Voice (browser speech synthesis) ----
  function speak(text){
    if(!voiceOn) return;
    if(!("speechSynthesis" in window)) return;
    const utter = new SpeechSynthesisUtterance(text);
    utter.rate = 1.02;
    utter.pitch = 1.02;
    window.speechSynthesis.speak(utter);
  }

  // ---- Conversation + BM handling ----
  function handleUserSubmit(){
    const text = messageInput.value.trim();
    if(!text) return;
    messageInput.value = "";

    const now = Date.now();
    tmHistory.push({role:"user", text, ts: now});
    pruneTM(now);

    addMessageToChat("user", text);
    updateMetricsFromText(text);

    showTyping();
    setTimeout(() => {
      const response = generateAIResponse(text);
      hideTyping();
      addMessageToChat("ai", response);
      updateMetricsFromText(response);

      const summary = summariseEpisode(text, response);
      const episode = {
        id: "ep_" + now,
        ts: now,
        userText: text,
        aiText: response,
        summary
      };
      convEpisodes.push(episode);
      if(convEpisodes.length > 500) convEpisodes.shift();

      if(learningOn && isMeaningfulEvent(text)){
        const title = makeEpisodeTitle(text, bmEntries.length + 1);
        const entry = {
          id: "bm_" + now,
          ts: now,
          title,
          text: summary,
          tags: ["conversation-episode"],
          source: "conversation"
        };
        bmEntries.push(entry);
        if(bmEntries.length > MAX_BM_LAYERS) bmEntries.shift();
        updateBMStats();
        drawBMCanvas();
        showRecallForEntry(entry);
      }

      saveState();
    }, 400);
  }

  function generateAIResponse(userText){
    const lower = userText.toLowerCase();

    // 1) seed rules
    const seeded = trySeedResponse(lower);
    if(seeded) return seeded;

    // 2) generic reflective answer
    const emo = analyzeEmotionFromText(userText);
    let prefix = "I am receiving this as ";
    if(emo.valenceLabel === "positive") prefix += "mostly positive ";
    else if(emo.valenceLabel === "negative") prefix += "emotionally heavy ";
    else prefix += "emotionally balanced ";

    prefix += "input with " + emo.arousalLabel + " arousal. ";

    return prefix +
      "Within the AURA-X Œ© frame I treat this as part of your TM window. " +
      "If it stays important and structured, I will keep a story-level episode in BM for future images or videos.";
  }

  // ---- Modals ----
  function openModal(id){
    const el = $(id);
    if(!el) return;
    el.classList.add("visible");
    if(id === "bmModal") renderBMList();
    if(id === "convModal") renderConvList();
    if(id === "intelModal") renderIntelList();
  }
  function closeModal(id){
    const el = $(id);
    if(!el) return;
    el.classList.remove("visible");
  }

  document.querySelectorAll(".modal-close").forEach(btn=>{
    btn.addEventListener("click", ()=>{
      const id = btn.getAttribute("data-close");
      if(id) closeModal(id);
    });
  });
  ["bmModal","convModal","intelModal","llmModal"].forEach(id=>{
    const el = $(id);
    if(!el) return;
    el.addEventListener("click", e=>{
      if(e.target === el) el.classList.remove("visible");
    });
  });

  // BM list render + search
  function renderBMList(filterText){
    const list = $("bmList");
    if(!list) return;
    const query = (filterText || "").toLowerCase();
    list.innerHTML = "";
    const items = bmEntries.filter(e=>{
      if(!query) return true;
      return (e.title && e.title.toLowerCase().includes(query)) ||
             (e.text && e.text.toLowerCase().includes(query));
    });
    if(items.length === 0){
      list.innerHTML = "<p style='font-size:.78rem;color:#6b7280;'>No BM episodes yet. Share a longer idea or story to create one.</p>";
      return;
    }
    items.slice().reverse().forEach(entry=>{
      const div = document.createElement("div");
      div.className = "bm-item";
      const header = document.createElement("div");
      header.className = "bm-item-header";
      header.innerHTML =
        "<span>" + (entry.title || "Episode") + "</span>" +
        "<span>" + new Date(entry.ts).toLocaleString() + "</span>";
      const text = document.createElement("div");
      text.className = "bm-item-text";
      text.textContent = entry.text;
      const badges = document.createElement("div");
      badges.className = "bm-item-badges";
      badges.textContent = "Source: " + (entry.source || "conversation");
      div.appendChild(header);
      div.appendChild(text);
      div.appendChild(badges);
      list.appendChild(div);
    });
  }

  // Conversation list render + search
  function renderConvList(filterText){
    const list = $("convList");
    if(!list) return;
    const query = (filterText || "").toLowerCase();
    list.innerHTML = "";
    const items = convEpisodes.filter(e=>{
      if(!query) return true;
      return e.summary.toLowerCase().includes(query) ||
             e.userText.toLowerCase().includes(query);
    });
    if(items.length === 0){
      list.innerHTML = "<p style='font-size:.78rem;color:#6b7280;'>No recent conversations stored (window is last 48 hours).</p>";
      return;
    }
    items.slice().reverse().forEach(ep=>{
      const div = document.createElement("div");
      div.className = "conv-item";
      const header = document.createElement("div");
      header.className = "conv-header";
      header.innerHTML =
        "<span>Episode ‚Äì " + new Date(ep.ts).toLocaleString() + "</span>" +
        "<span>TM window</span>";
      const text = document.createElement("div");
      text.className = "conv-text";
      text.textContent = ep.summary;
      div.appendChild(header);
      div.appendChild(text);
      list.appendChild(div);
    });
  }

  // Intelligence modal content
  function renderIntelList(){
    const list = $("intelList");
    if(!list) return;
    list.innerHTML = "";
    seedRules.forEach(rule=>{
      const div = document.createElement("div");
      div.className = "intel-item";
      const header = document.createElement("div");
      header.className = "intel-header";
      header.innerHTML = "<span>Seed pattern</span>";
      const q = document.createElement("div");
      q.textContent = rule.pattern.toString();
      const a = document.createElement("div");
      a.style.marginTop = "4px";
      a.textContent = "Example answer: " + rule.replies[0];
      div.appendChild(header);
      div.appendChild(q);
      div.appendChild(a);
      list.appendChild(div);
    });
  }

  // ---- Options controls ----
  const headerControls = $("headerControls");
  $("optionsToggle").addEventListener("click", ()=>{
    headerControls.classList.toggle("open");
  });

  $("voiceToggle").addEventListener("click", ()=>{
    voiceOn = !voiceOn;
    $("voiceToggle").textContent = voiceOn ? "üîà Voice: ON" : "üîà Voice: OFF";
  });

  $("learningToggle").addEventListener("click", ()=>{
    learningOn = !learningOn;
    $("learningToggle").textContent = learningOn ? "üìö Learning: ON" : "üìö Learning: OFF";
  });

  $("intelButton").addEventListener("click", ()=>openModal("intelModal"));
  $("bmOpenModal").addEventListener("click", ()=>openModal("bmModal"));
  $("convOpenModal").addEventListener("click", ()=>openModal("convModal"));
  $("llmSettingsButton").addEventListener("click", ()=>openModal("llmModal"));

  $("faithButton").addEventListener("click", ()=>{
    // simple toggle between neutral and light positive stabilisation
    if(lambdaFaith === 0){
      lambdaFaith = 0.2;
      $("faithButton").textContent = "üîò Faith: soft positive";
    }else{
      lambdaFaith = 0;
      $("faithButton").textContent = "üîò Faith lens";
    }
  });

  $("bmSearch").addEventListener("input", e=>renderBMList(e.target.value));
  $("convSearch").addEventListener("input", e=>renderConvList(e.target.value));

  // ---- Input handlers ----
  sendButton.addEventListener("click", handleUserSubmit);
  messageInput.addEventListener("keydown", e=>{
    if(e.key === "Enter" && !e.shiftKey){
      e.preventDefault();
      handleUserSubmit();
    }
  });

  window.addEventListener("resize", drawBMCanvas);

  // ---- Initialisation ----
  function intro(){
    const introText =
      "Hello, I am AURA-X Œ©. I simulate synthetic emotions by combining your live TM inputs with my BM episodes. " +
      "Small talk stays only inside a 48-hour TM window; meaningful ideas and stories are promoted into BM as episodes.";
    addMessageToChat("ai", introText);
    updateMetricsFromText(introText);
  }

  loadState();
  updateBMStats();
  drawBMCanvas();
  intro();
})();
</script>
</body>
</html>