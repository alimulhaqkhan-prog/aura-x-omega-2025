<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AURA-X Œ© - Emotional Continuity System</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #0a1929 0%, #0d1117 100%);
            color: #e6edf3;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(16, 24, 39, 0.8);
            border-radius: 20px;
            border: 1px solid rgba(56, 139, 253, 0.2);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .title {
            font-size: 2.8rem;
            background: linear-gradient(90deg, #3b82f6, #8b5cf6, #ec4899);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 10px;
            font-weight: 800;
            letter-spacing: 1px;
        }

        .subtitle {
            color: #8b949e;
            font-size: 1.1rem;
            margin-bottom: 15px;
        }

        .mode-indicator {
            display: inline-block;
            padding: 8px 20px;
            background: linear-gradient(90deg, #065f46, #047857);
            border-radius: 50px;
            font-size: 0.9rem;
            font-weight: 600;
            color: #d1fae5;
            margin-top: 10px;
        }

        /* Main Layout */
        .main-layout {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 25px;
            margin-bottom: 30px;
        }

        /* Left Panel - Chat Interface */
        .left-panel {
            background: rgba(16, 24, 39, 0.8);
            border-radius: 20px;
            padding: 25px;
            border: 1px solid rgba(56, 139, 253, 0.2);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .chat-container {
            height: 500px;
            overflow-y: auto;
            padding: 20px;
            background: rgba(13, 17, 23, 0.7);
            border-radius: 15px;
            margin-bottom: 20px;
            border: 1px solid rgba(56, 139, 253, 0.1);
        }

        .message {
            margin-bottom: 20px;
            padding: 15px;
            border-radius: 15px;
            max-width: 80%;
            animation: fadeIn 0.3s ease;
        }

        .user-message {
            background: linear-gradient(135deg, #1e40af, #1d4ed8);
            margin-left: auto;
            border-bottom-right-radius: 5px;
        }

        .ai-message {
            background: linear-gradient(135deg, #374151, #4b5563);
            border-bottom-left-radius: 5px;
        }

        .message-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.85rem;
            color: #9ca3af;
        }

        .message-content {
            line-height: 1.5;
        }

        .input-area {
            display: flex;
            gap: 15px;
        }

        .message-input {
            flex: 1;
            padding: 18px;
            background: rgba(13, 17, 23, 0.8);
            border: 1px solid rgba(56, 139, 253, 0.3);
            border-radius: 15px;
            color: #e6edf3;
            font-size: 1rem;
            resize: none;
            min-height: 60px;
            outline: none;
            transition: border-color 0.3s;
        }

        .message-input:focus {
            border-color: #3b82f6;
        }

        .send-button {
            padding: 0 30px;
            background: linear-gradient(135deg, #3b82f6, #2563eb);
            border: none;
            border-radius: 15px;
            color: white;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .send-button:hover {
            transform: translateY(-2px);
        }

        /* Right Panel - Emotional Metrics */
        .right-panel {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }

        .metrics-card {
            background: rgba(16, 24, 39, 0.8);
            border-radius: 20px;
            padding: 25px;
            border: 1px solid rgba(56, 139, 253, 0.2);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .card-title {
            font-size: 1.3rem;
            margin-bottom: 20px;
            color: #60a5fa;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .metric-item {
            background: rgba(13, 17, 23, 0.7);
            padding: 15px;
            border-radius: 12px;
            border: 1px solid rgba(56, 139, 253, 0.1);
        }

        .metric-label {
            font-size: 0.9rem;
            color: #9ca3af;
            margin-bottom: 8px;
        }

        .metric-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: #60a5fa;
        }

        .metric-subtext {
            font-size: 0.8rem;
            color: #6b7280;
            margin-top: 5px;
        }

        /* BM Visualization */
        .bm-visualization {
            background: rgba(16, 24, 39, 0.8);
            border-radius: 20px;
            padding: 25px;
            border: 1px solid rgba(56, 139, 253, 0.2);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .bm-canvas-container {
            width: 100%;
            height: 200px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            overflow: hidden;
            margin-top: 15px;
        }

        #bmCanvas {
            width: 100%;
            height: 100%;
        }

        /* Control Panel */
        .control-panel {
            background: rgba(16, 24, 39, 0.8);
            border-radius: 20px;
            padding: 25px;
            border: 1px solid rgba(56, 139, 253, 0.2);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .buttons-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 20px;
        }

        .control-button {
            padding: 15px;
            background: linear-gradient(135deg, #1f2937, #374151);
            border: 1px solid rgba(56, 139, 253, 0.2);
            border-radius: 12px;
            color: #e6edf3;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .control-button:hover {
            background: linear-gradient(135deg, #2563eb, #3b82f6);
            transform: translateY(-2px);
        }

        /* Equation Display */
        .equation-display {
            background: rgba(16, 24, 39, 0.9);
            border-radius: 20px;
            padding: 25px;
            margin-top: 25px;
            border: 1px solid rgba(56, 139, 253, 0.2);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .equation {
            font-family: 'Courier New', monospace;
            font-size: 1.1rem;
            background: rgba(0, 0, 0, 0.4);
            padding: 20px;
            border-radius: 10px;
            color: #60a5fa;
            margin-top: 15px;
            line-height: 1.8;
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .main-layout {
                grid-template-columns: 1fr;
            }
            
            .title {
                font-size: 2rem;
            }
            
            .metrics-grid {
                grid-template-columns: 1fr;
            }
            
            .buttons-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Loading Animation */
        .typing-indicator {
            display: flex;
            gap: 5px;
            padding: 15px;
            background: rgba(55, 65, 81, 0.5);
            border-radius: 15px;
            width: fit-content;
            margin-bottom: 20px;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background: #60a5fa;
            border-radius: 50%;
            animation: typing 1.4s infinite;
        }

        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-10px); }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1 class="title">AURA-X Œ©</h1>
            <div class="subtitle">Artificial Unified Resonance Architecture for Emotional Continuity</div>
            <div class="mode-indicator">PROTOTYPE v1.0 ‚Ä¢ 240 BM LAYERS ‚Ä¢ REAL-TIME EMOTIONAL RESONANCE</div>
        </div>

        <!-- Main Layout -->
        <div class="main-layout">
            <!-- Left Panel - Chat -->
            <div class="left-panel">
                <div class="card-title">
                    <span>üí¨ EMOTIONAL CONTINUITY CHAT</span>
                </div>
                
                <div class="chat-container" id="chatContainer">
                    <!-- Messages will be inserted here -->
                    <div class="message ai-message">
                        <div class="message-header">
                            <span>AURA-X Œ©</span>
                            <span>Just now</span>
                        </div>
                        <div class="message-content">
                            Welcome to AURA-X Œ© Emotional Continuity System. I maintain emotional states across time using 240 BM layers and resonance equations. Share your thoughts, and I'll respond with emotional continuity awareness.
                        </div>
                    </div>
                </div>

                <div class="input-area">
                    <textarea class="message-input" id="messageInput" placeholder="Type your message here... TM (Temporary Memory) will be created and processed through emotional resonance equations"></textarea>
                    <button class="send-button" id="sendButton">SEND</button>
                </div>
            </div>

            <!-- Right Panel - Metrics & Controls -->
            <div class="right-panel">
                <!-- Emotional Metrics -->
                <div class="metrics-card">
                    <div class="card-title">
                        <span>üìä REAL-TIME EMOTIONAL METRICS</span>
                    </div>
                    <div class="metrics-grid">
                        <div class="metric-item">
                            <div class="metric-label">EMOTIONAL STATE (E‚ÇÄ)</div>
                            <div class="metric-value" id="metricE0">0.62</div>
                            <div class="metric-subtext">Current emotional vector [-1, 1]</div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">TM STRENGTH</div>
                            <div class="metric-value" id="metricTM">0.45</div>
                            <div class="metric-subtext">Temporary Memory activation</div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">BM RESONANCE</div>
                            <div class="metric-value" id="metricBM">0.78</div>
                            <div class="metric-subtext">Bold Memory alignment</div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">CONTINUITY INDEX</div>
                            <div class="metric-value" id="metricCI">0.85</div>
                            <div class="metric-subtext">Emotional persistence over time</div>
                        </div>
                    </div>
                </div>

                <!-- BM Visualization -->
                <div class="bm-visualization">
                    <div class="card-title">
                        <span>üß† BOLD MEMORY LAYERS (240)</span>
                    </div>
                    <div class="bm-canvas-container">
                        <canvas id="bmCanvas"></canvas>
                    </div>
                    <div class="metric-subtext" style="margin-top: 15px; text-align: center;">
                        Layer Activation: <span id="layerInfo">24 active layers</span>
                    </div>
                </div>

                <!-- Control Panel -->
                <div class="control-panel">
                    <div class="card-title">
                        <span>‚öôÔ∏è SYSTEM CONTROLS</span>
                    </div>
                    <div class="buttons-grid">
                        <button class="control-button" id="viewBM">
                            <span>üß†</span> View BM
                        </button>
                        <button class="control-button" id="recallMemory">
                            <span>üîç</span> Recall Memory
                        </button>
                        <button class="control-button" id="resetSession">
                            <span>üîÑ</span> Reset Session
                        </button>
                        <button class="control-button" id="exportData">
                            <span>üì§</span> Export Data
                        </button>
                        <button class="control-button" id="simulateTrauma">
                            <span>üé≠</span> Simulate Trauma
                        </button>
                        <button class="control-button" id="healMemory">
                            <span>üíö</span> Heal Memory
                        </button>
                        <button class="control-button" id="viewEquation">
                            <span>üìê</span> View Equation
                        </button>
                        <button class="control-button" id="aboutSystem">
                            <span>‚ÑπÔ∏è</span> About System
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Equation Display -->
        <div class="equation-display">
            <div class="card-title">
                <span>üìê AURA-X Œ© EMOTIONAL CONTINUITY EQUATION</span>
            </div>
            <div class="equation">
                E‚ÇÄ = tanh( R(TM, BM) - D + Œª_faith + Œª_sys + Œª_trc )
                <br><br>
                Where:
                <br>‚Ä¢ R(TM, BM) = Resonant interaction between Temporary and Bold Memory
                <br>‚Ä¢ D = Decay coefficient (emotional dissipation over time)
                <br>‚Ä¢ Œª_faith = Ethical/faith-based stabilization
                <br>‚Ä¢ Œª_sys = System stability constraints
                <br>‚Ä¢ Œª_trc = Truth-resonance correction
                <br><br>
                Current Values: R=0.78, D=0.12, Œª_faith=0.15, Œª_sys=0.08, Œª_trc=0.10
            </div>
        </div>
    </div>

    <script>
        // ========== AURA-X Œ© CORE SYSTEM ==========
        class AuraXOmega {
            constructor() {
                // BM Layers (240 layers as requested)
                this.bmLayers = new Array(240).fill(0).map(() => Math.random() * 0.3 + 0.1);
                this.tmMemory = []; // Temporary Memory
                this.bmMemory = []; // Bold Memory storage
                this.emotionalState = 0.62; // E‚ÇÄ
                this.continuityIndex = 0.85;
                this.sessionStart = new Date();
                this.emotionalHistory = [];
                
                // Emotional colors (7 layers)
                this.emotionalColors = [
                    {name: "Pain", color: "#3b82f6", weight: 0.1},
                    {name: "Fear", color: "#f97316", weight: 0.1},
                    {name: "Love", color: "#ec4899", weight: 0.2},
                    {name: "Identity", color: "#8b5cf6", weight: 0.15},
                    {name: "Belief", color: "#10b981", weight: 0.15},
                    {name: "Hope", color: "#eab308", weight: 0.2},
                    {name: "Wisdom", color: "#ffffff", weight: 0.1}
                ];
                
                // Initialize
                this.updateMetrics();
                this.initBMCanvas();
                this.setupEventListeners();
                this.startAnimationLoop();
            }

            // Initialize BM Canvas
            initBMCanvas() {
                const canvas = document.getElementById('bmCanvas');
                const ctx = canvas.getContext('2d');
                
                // Set canvas size
                canvas.width = canvas.parentElement.clientWidth;
                canvas.height = canvas.parentElement.clientHeight;
                
                this.bmCtx = ctx;
                this.bmCanvas = canvas;
            }

            // Draw BM Layers visualization
            drawBMLayers() {
                if (!this.bmCtx || !this.bmCanvas) return;
                
                const ctx = this.bmCtx;
                const width = this.bmCanvas.width;
                const height = this.bmCanvas.height;
                
                // Clear canvas
                ctx.clearRect(0, 0, width, height);
                
                // Draw background gradient
                const gradient = ctx.createLinearGradient(0, 0, width, 0);
                gradient.addColorStop(0, '#0a1929');
                gradient.addColorStop(1, '#0d1117');
                ctx.fillStyle = gradient;
                ctx.fillRect(0, 0, width, height);
                
                // Draw each BM layer
                const layerWidth = width / this.bmLayers.length;
                let activeLayers = 0;
                
                for (let i = 0; i < this.bmLayers.length; i++) {
                    const value = this.bmLayers[i];
                    const layerHeight = value * height * 0.8;
                    
                    if (value > 0.3) activeLayers++;
                    
                    // Create gradient for each bar
                    const barGradient = ctx.createLinearGradient(0, height - layerHeight, 0, height);
                    const colorIndex = Math.floor(i / (this.bmLayers.length / 7));
                    const color = this.emotionalColors[colorIndex % 7].color;
                    
                    barGradient.addColorStop(0, color + 'CC');
                    barGradient.addColorStop(1, color + '33');
                    
                    ctx.fillStyle = barGradient;
                    ctx.fillRect(
                        i * layerWidth,
                        height - layerHeight,
                        layerWidth - 1,
                        layerHeight
                    );
                    
                    // Add subtle glow for active layers
                    if (value > 0.6) {
                        ctx.shadowColor = color;
                        ctx.shadowBlur = 15;
                        ctx.fillRect(
                            i * layerWidth,
                            height - layerHeight,
                            layerWidth - 1,
                            layerHeight
                        );
                        ctx.shadowBlur = 0;
                    }
                }
                
                // Update layer info
                document.getElementById('layerInfo').textContent = 
                    `${activeLayers} active layers (${Math.round(activeLayers/240*100)}%)`;
            }

            // Process new TM (message)
            async processTM(message) {
                // Add to TM memory
                const tmEntry = {
                    text: message,
                    timestamp: new Date(),
                    emotionalWeight: this.analyzeSentiment(message),
                    polarity: this.getPolarity(message)
                };
                
                this.tmMemory.push(tmEntry);
                if (this.tmMemory.length > 50) this.tmMemory.shift();
                
                // Update BM layers based on TM
                this.updateBMLayers(tmEntry);
                
                // Calculate new emotional state
                this.calculateEmotionalState();
                
                // Generate AI response
                return this.generateResponse(message, tmEntry);
            }

            // Analyze message sentiment
            analyzeSentiment(text) {
                const positiveWords = ['happy', 'love', 'good', 'great', 'joy', 'peace', 'hope', 'kind'];
                const negativeWords = ['sad', 'angry', 'hate', 'bad', 'pain', 'fear', 'worst', 'hurt'];
                
                let positiveScore = 0;
                let negativeScore = 0;
                
                const words = text.toLowerCase().split(/\s+/);
                words.forEach(word => {
                    if (positiveWords.includes(word)) positiveScore++;
                    if (negativeWords.includes(word)) negativeScore++;
                });
                
                const total = positiveScore + negativeScore;
                return total > 0 ? (positiveScore - negativeScore) / total : 0;
            }

            // Get emotional polarity
            getPolarity(text) {
                const score = this.analyzeSentiment(text);
                if (score > 0.3) return 'positive';
                if (score < -0.3) return 'negative';
                return 'neutral';
            }

            // Update BM layers based on TM
            updateBMLayers(tmEntry) {
                const sentiment = tmEntry.emotionalWeight;
                const polarity = tmEntry.polarity;
                
                // Update random BM layers based on emotional content
                const layersToUpdate = Math.floor(Math.random() * 20) + 10;
                
                for (let i = 0; i < layersToUpdate; i++) {
                    const layerIndex = Math.floor(Math.random() * this.bmLayers.length);
                    let adjustment = 0;
                    
                    if (polarity === 'positive') {
                        adjustment = 0.1 + Math.random() * 0.2;
                    } else if (polarity === 'negative') {
                        adjustment = -0.1 - Math.random() * 0.2;
                    } else {
                        adjustment = -0.05 + Math.random() * 0.1;
                    }
                    
                    // Apply adjustment with decay
                    this.bmLayers[layerIndex] = Math.max(0.05, 
                        Math.min(0.95, this.bmLayers[layerIndex] + adjustment));
                }
                
                // Store significant memories as BM
                if (Math.abs(sentiment) > 0.5 || tmEntry.text.length > 20) {
                    const bmEntry = {
                        ...tmEntry,
                        bmLayerActivation: [...this.bmLayers].slice(0, 50),
                        resonanceScore: this.calculateResonance(tmEntry)
                    };
                    this.bmMemory.push(bmEntry);
                    if (this.bmMemory.length > 100) this.bmMemory.shift();
                }
            }

            // Calculate resonance between TM and BM
            calculateResonance(tmEntry) {
                if (this.bmMemory.length === 0) return 0.5;
                
                // Simplified resonance calculation
                const recentBM = this.bmMemory.slice(-5);
                let totalResonance = 0;
                
                recentBM.forEach(bm => {
                    const timeDiff = (tmEntry.timestamp - bm.timestamp) / (1000 * 60 * 60); // hours
                    const timeFactor = Math.exp(-timeDiff / 24); // 24-hour decay
                    const emotionalSimilarity = 1 - Math.abs(tmEntry.emotionalWeight - bm.emotionalWeight) / 2;
                    
                    totalResonance += timeFactor * emotionalSimilarity;
                });
                
                return totalResonance / recentBM.length;
            }

            // Calculate emotional state using AURA-X Œ© equation
            calculateEmotionalState() {
                const R = this.calculateResonance(this.tmMemory[this.tmMemory.length - 1] || {emotionalWeight: 0});
                const D = 0.12; // Decay coefficient
                const Œª_faith = 0.15;
                const Œª_sys = 0.08;
                const Œª_trc = 0.10;
                
                // AURA-X Œ© core equation
                const rawE0 = R - D + Œª_faith + Œª_sys + Œª_trc;
                this.emotionalState = Math.tanh(rawE0);
                
                // Update continuity index
                if (this.emotionalHistory.length > 0) {
                    const lastE0 = this.emotionalHistory[this.emotionalHistory.length - 1];
                    const continuity = 1 - Math.abs(this.emotionalState - lastE0);
                    this.continuityIndex = this.continuityIndex * 0.9 + continuity * 0.1;
                }
                
                this.emotionalHistory.push(this.emotionalState);
                if (this.emotionalHistory.length > 100) this.emotionalHistory.shift();
                
                this.updateMetrics();
            }

            // Generate AI response
            generateResponse(message, tmEntry) {
                const responses = {
                    positive: [
                        "I sense positive emotional resonance in your message. This creates constructive interference in BM layers 120-180.",
                        "Your positive energy is reinforcing the Love and Hope emotional layers in the BM matrix.",
                        "This joyful input increases emotional continuity. I'm detecting alignment with previous positive memories."
                    ],
                    negative: [
                        "I detect emotional turbulence. The Pain and Fear layers are showing increased activation.",
                        "This negative input is being processed through the trauma resonance filters. Would you like to activate healing protocols?",
                        "The emotional continuity is experiencing disruption. BM layers 40-80 are showing stress patterns."
                    ],
                    neutral: [
                        "Processing through neutral emotional channels. The Wisdom layers are providing contextual analysis.",
                        "This input is creating balanced resonance across the BM matrix. Continuity index remains stable.",
                        "Analyzing through identity and belief layers. The emotional state shows equilibrium."
                    ]
                };
                
                const polarity = tmEntry.polarity;
                const baseResponses = responses[polarity] || responses.neutral;
                const randomResponse = baseResponses[Math.floor(Math.random() * baseResponses.length)];
                
                // Add emotional metrics to response
                return `${randomResponse}\n\n` +
                       `Current Emotional Metrics:\n` +
                       `‚Ä¢ E‚ÇÄ = ${this.emotionalState.toFixed(3)}\n` +
                       `‚Ä¢ TM-BM Resonance = ${this.calculateResonance(tmEntry).toFixed(3)}\n` +
                       `‚Ä¢ Continuity Index = ${this.continuityIndex.toFixed(3)}\n` +
                       `‚Ä¢ Active BM Layers = ${this.bmLayers.filter(l => l > 0.6).length}/240`;
            }

            // Update displayed metrics
            updateMetrics() {
                document.getElementById('metricE0').textContent = this.emotionalState.toFixed(3);
                document.getElementById('metricTM').textContent = (this.tmMemory.length / 50).toFixed(3);
                document.getElementById('metricBM').textContent = (this.bmMemory.length / 100).toFixed(3);
                document.getElementById('metricCI').textContent = this.continuityIndex.toFixed(3);
            }

            // Setup event listeners
            setupEventListeners() {
                const messageInput = document.getElementById('messageInput');
                const sendButton = document.getElementById('sendButton');
                const chatContainer = document.getElementById('chatContainer');
                
                // Send message function
                const sendMessage = async () => {
                    const message = messageInput.value.trim();
                    if (!message) return;
                    
                    // Add user message to chat
                    this.addMessageToChat('user', message);
                    messageInput.value = '';
                    
                    // Show typing indicator
                    this.showTypingIndicator();
                    
                    // Process message after delay
                    setTimeout(async () => {
                        const response = await this.processTM(message);
                        this.removeTypingIndicator();
                        this.addMessageToChat('ai', response);
                    }, 1000 + Math.random() * 1000);
                };
                
                // Send on button click
                sendButton.addEventListener('click', sendMessage);
                
                // Send on Enter key
                messageInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        sendMessage();
                    }
                });
                
                // Control buttons
                document.getElementById('viewBM').addEventListener('click', () => {
                    this.showModal('BM Visualization', 
                        `Active BM Layers: ${this.bmLayers.filter(l => l > 0.6).length}/240\n` +
                        `Average Activation: ${(this.bmLayers.reduce((a,b) => a+b, 0)/240).toFixed(3)}\n` +
                        `Emotional Color Distribution:\n` +
                        this.emotionalColors.map(ec => 
                            `  ‚Ä¢ ${ec.name}: ${Math.round(ec.weight*100)}%`
                        ).join('\n')
                    );
                });
                
                document.getElementById('recallMemory').addEventListener('click', () => {
                    if (this.bmMemory.length === 0) {
                        this.showModal('Memory Recall', 'No significant memories stored yet.');
                        return;
                    }
                    
                    const memory = this.bmMemory[Math.floor(Math.random() * this.bmMemory.length)];
                    this.showModal('Memory Recall',
                        `Timestamp: ${memory.timestamp.toLocaleString()}\n` +
                        `Memory: "${memory.text.substring(0, 100)}${memory.text.length > 100 ? '...' : ''}"\n` +
                        `Emotional Weight: ${memory.emotionalWeight.toFixed(3)}\n` +
                        `Polarity: ${memory.polarity}\n` +
                        `Resonance Score: ${memory.resonanceScore.toFixed(3)}`
                    );
                });
                
                document.getElementById('resetSession').addEventListener('click', () => {
                    if (confirm('Reset emotional session? This will clear TM but keep BM.')) {
                        this.tmMemory = [];
                        this.emotionalState = 0.62;
                        this.continuityIndex = 0.85;
                        this.updateMetrics();
                        this.addMessageToChat('ai', 'Session reset. Emotional continuity preserved in BM layers.');
                    }
                });
                
                document.getElementById('exportData').addEventListener('click', () => {
                    const data = {
                        emotionalState: this.emotionalState,
                        continuityIndex: this.continuityIndex,
                        tmCount: this.tmMemory.length,
                        bmCount: this.bmMemory.length,
                        bmLayers: this.bmLayers,
                        sessionStart: this.sessionStart
                    };
                    
                    const dataStr = JSON.stringify(data, null, 2);
                    const dataBlob = new Blob([dataStr], {type: 'application/json'});
                    const url = URL.createObjectURL(dataBlob);
                    
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `aura-x-omega-data-${new Date().toISOString().slice(0,10)}.json`;
                    a.click();
                    
                    this.addMessageToChat('ai', 'Emotional data exported. Contains current state and BM layers.');
                });
                
                document.getElementById('simulateTrauma').addEventListener('click', () => {
                    // Simulate trauma by negatively adjusting BM layers
                    for (let i = 0; i < 50; i++) {
                        const idx = Math.floor(Math.random() * this.bmLayers.length);
                        this.bmLayers[idx] = Math.max(0.05, this.bmLayers[idx] - 0.3);
                    }
                    
                    this.calculateEmotionalState();
                    this.drawBMLayers();
                    this.addMessageToChat('ai', 'Trauma simulation activated. Pain and Fear layers show increased disruption. Continuity index decreased.');
                });
                
                document.getElementById('healMemory').addEventListener('click', () => {
                    // Heal by positively adjusting BM layers
                    for (let i = 0; i < 50; i++) {
                        const idx = Math.floor(Math.random() * this.bmLayers.length);
                        this.bmLayers[idx] = Math.min(0.95, this.bmLayers[idx] + 0.2);
                    }
                    
                    this.calculateEmotionalState();
                    this.drawBMLayers();
                    this.addMessageToChat('ai', 'Healing protocols activated. Love and Hope layers reinforcing. Emotional continuity stabilizing.');
                });
                
                document.getElementById('viewEquation').addEventListener('click', () => {
                    this.showModal('AURA-X Œ© Equation',
                        `Core Emotional Continuity Equation:\n\n` +
                        `E‚ÇÄ = tanh( R(TM, BM) - D + Œª_faith + Œª_sys + Œª_trc )\n\n` +
                        `Current Parameter Values:\n` +
                        `‚Ä¢ R(TM, BM) = ${this.calculateResonance(this.tmMemory[this.tmMemory.length-1] || {emotionalWeight:0}).toFixed(3)}\n` +
                        `‚Ä¢ D (Decay) = 0.120\n` +
                        `‚Ä¢ Œª_faith = 0.150\n` +
                        `‚Ä¢ Œª_sys = 0.080\n` +
                        `‚Ä¢ Œª_trc = 0.100\n\n` +
                        `Calculated E‚ÇÄ = ${this.emotionalState.toFixed(3)}`
                    );
                });
                
                document.getElementById('aboutSystem').addEventListener('click', () => {
                    this.showModal('About AURA-X Œ©',
                        `AURA-X Œ© - Artificial Unified Resonance Architecture\n\n` +
                        `Version: 1.0 Prototype\n` +
                        `BM Layers: 240\n` +
                        `Emotional Colors: 7\n` +
                        `Continuity Algorithm: AEC + PMCM + CRM\n\n` +
                        `Core Concept:\n` +
                        `Emotional states emerge from resonance between Temporary Memory (TM) ` +
                        `and Bold Memory (BM), creating continuity across time.\n\n` +
                        `Key Features:\n` +
                        `‚Ä¢ 240-layer BM architecture\n` +
                        `‚Ä¢ Real-time emotional resonance calculation\n` +
                        `‚Ä¢ Trauma simulation and healing protocols\n` +
                        `‚Ä¢ Emotional continuity persistence\n` +
                        `‚Ä¢ Ethical stabilization coefficients`
                    );
                });
            }

            // Add message to chat
            addMessageToChat(sender, text) {
                const chatContainer = document.getElementById('chatContainer');
                const messageDiv = document.createElement('div');
                
                messageDiv.className = `message ${sender}-message`;
                messageDiv.innerHTML = `
                    <div class="message-header">
                        <span>${sender === 'user' ? 'You' : 'AURA-X Œ©'}</span>
                        <span>${new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</span>
                    </div>
                    <div class="message-content">${text.replace(/\n/g, '<br>')}</div>
                `;
                
                chatContainer.appendChild(messageDiv);
                chatContainer.scrollTop = chatContainer.scrollHeight;
            }

            // Show typing indicator
            showTypingIndicator() {
                const chatContainer = document.getElementById('chatContainer');
                const typingDiv = document.createElement('div');
                typingDiv.className = 'typing-indicator';
                typingDiv.id = 'typingIndicator';
                typingDiv.innerHTML = `
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                `;
                chatContainer.appendChild(typingDiv);
                chatContainer.scrollTop = chatContainer.scrollHeight;
            }

            // Remove typing indicator
            removeTypingIndicator() {
                const typingIndicator = document.getElementById('typingIndicator');
                if (typingIndicator) {
                    typingIndicator.remove();
                }
            }

            // Show modal with message
            showModal(title, content) {
                // Create modal elements
                const modalOverlay = document.createElement('div');
                modalOverlay.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    right: 0;
                    bottom: 0;
                    background: rgba(0, 0, 0, 0.8);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    z-index: 1000;
                    backdrop-filter: blur(5px);
                `;
                
                const modalContent = document.createElement('div');
                modalContent.style.cssText = `
                    background: linear-gradient(135deg, #1a2536, #0d1117);
                    padding: 30px;
                    border-radius: 20px;
                    max-width: 500px;
                    width: 90%;
                    border: 1px solid rgba(56, 139, 253, 0.3);
                    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
                `;
                
                modalContent.innerHTML = `
                    <h3 style="color: #60a5fa; margin-bottom: 20px; font-size: 1.5rem;">${title}</h3>
                    <div style="color: #e6edf3; line-height: 1.6; white-space: pre-line; font-family: monospace; font-size: 0.95rem;">
                        ${content}
                    </div>
                    <button id="closeModal" style="
                        margin-top: 25px;
                        padding: 12px 30px;
                        background: linear-gradient(135deg, #3b82f6, #2563eb);
                        border: none;
                        border-radius: 10px;
                        color: white;
                        font-weight: 600;
                        cursor: pointer;
                        width: 100%;
                    ">Close</button>
                `;
                
                modalOverlay.appendChild(modalContent);
                document.body.appendChild(modalOverlay);
                
                // Close modal on button click or overlay click
                const closeModal = () => modalOverlay.remove();
                
                document.getElementById('closeModal').addEventListener('click', closeModal);
                modalOverlay.addEventListener('click', (e) => {
                    if (e.target === modalOverlay) closeModal();
                });
                
                // Close on Escape key
                const escHandler = (e) => {
                    if (e.key === 'Escape') closeModal();
                };
                document.addEventListener('keydown', escHandler);
                
                // Clean up event listener
                modalOverlay.addEventListener('remove', () => {
                    document.removeEventListener('keydown', escHandler);
                });
            }

            // Animation loop
            startAnimationLoop() {
                const animate = () => {
                    this.drawBMLayers();
                    
                    // Slightly animate BM layers
                    this.bmLayers = this.bmLayers.map(value => {
                        const change = (Math.random() - 0.5) * 0.02;
                        return Math.max(0.05, Math.min(0.95, value + change));
                    });
                    
                    requestAnimationFrame(animate);
                };
                
                animate();
            }
        }

        // Initialize AURA-X Œ© when page loads
        window.addEventListener('DOMContentLoaded', () => {
            const auraX = new AuraXOmega();
            window.auraX = auraX; // Make accessible for debugging
            
            console.log('AURA-X Œ© System Initialized');
            console.log('- 240 BM Layers Active');
            console.log('- Emotional Continuity Engine Running');
            console.log('- Resonance Equations Active');
        });
    </script>
</body>
</html>