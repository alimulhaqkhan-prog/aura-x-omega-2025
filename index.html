<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>AURA-X Î© â€” Emotional Continuity</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"/>

<style>
/* =========================
   CODE-2 UI â€” MOBILE FIRST
========================= */
:root{
  --bg:#020617; --card:#0b1220; --ink:#e5e7eb; --muted:#94a3b8;
  --accent:#38bdf8; --accent2:#22d3ee; --ok:#22c55e; --warn:#f59e0b;
  --radius:16px;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu;
  color:var(--ink);
  background:
    radial-gradient(1200px 600px at 80% -10%, #0ea5e933, transparent 40%),
    radial-gradient(900px 500px at 20% -10%, #38bdf833, transparent 45%),
    var(--bg);
}

/* App shell */
.app{
  max-width:480px; margin:0 auto; min-height:100%;
  display:flex; flex-direction:column;
}
.header{
  padding:14px 16px;
  text-align:center; font-weight:700; letter-spacing:.4px;
  background:linear-gradient(180deg,#0b1220,#070b16);
  border-bottom:1px solid #0f172a;
}
.header small{display:block;color:var(--muted);font-weight:500}

/* Hero / engine state */
.hero{
  margin:12px; padding:14px; border-radius:var(--radius);
  background:linear-gradient(180deg,#0b1220,#060a14);
  box-shadow:0 20px 60px #0006;
}
.ethic{
  border:1px solid #facc15aa; border-radius:12px; padding:10px;
  color:#fde68a; background:#020617aa; font-size:13px;
}
.engine{
  margin-top:10px; padding:12px; border-radius:999px;
  background:linear-gradient(90deg,#22d3ee,#38bdf8);
  color:#020617; text-align:center; font-weight:800;
}
.options-btn{
  margin-top:10px; display:inline-flex; gap:8px; align-items:center;
  padding:8px 12px; border-radius:999px; border:1px solid #0f172a;
  background:#020617; color:var(--ink);
}

/* Metrics â€” one line */
.metrics{
  display:flex; gap:8px; margin:12px;
}
.metric{
  flex:1; padding:10px; border-radius:14px; background:var(--card);
  text-align:center; border:1px solid #0f172a;
}
.metric b{display:block; font-size:18px}
.metric small{color:var(--muted); font-size:11px}

/* Console (BIG) */
.console{
  margin:12px; padding:12px; border-radius:var(--radius);
  background:#020617; border:1px solid #0f172a;
  min-height:220px; max-height:42vh; overflow:auto;
  font-family:ui-monospace, SFMono-Regular, Menlo, monospace;
  font-size:13px;
}
.console .line{margin-bottom:8px}

/* Chat */
.chat{
  flex:1; margin:12px; padding:10px;
  background:var(--card); border-radius:var(--radius);
  overflow:auto; border:1px solid #0f172a;
}
.msg{max-width:85%; padding:10px 12px; border-radius:12px; margin:8px 0}
.user{margin-left:auto; background:linear-gradient(90deg,#38bdf8,#22d3ee); color:#020617}
.bot{background:#020617}

/* Input */
.input{
  display:flex; gap:8px; padding:12px; position:sticky; bottom:0;
  background:linear-gradient(180deg,transparent,#020617 40%);
}
.input input{
  flex:1; padding:12px 14px; border-radius:999px;
  border:1px solid #0f172a; background:#020617; color:var(--ink);
}
.input button{
  padding:12px 18px; border-radius:999px; border:none;
  background:#38bdf8; color:#020617; font-weight:800;
}

/* Formula bar */
.formula{
  margin:8px 12px 14px; color:var(--muted); font-size:11px; text-align:center;
}

/* ===== Modals (Code-2 style) ===== */
.modal{
  position:fixed; inset:0; display:none; align-items:center; justify-content:center;
  background:#0008; z-index:50;
}
.modal .card{
  width:min(92vw,420px); background:#fff; color:#020617;
  border-radius:16px; padding:14px; box-shadow:0 30px 80px #0006;
}
.modal h3{margin:0 0 6px}
.modal p{margin:0 0 10px; color:#334155}
.modal .row{display:flex; gap:8px; flex-wrap:wrap}
.modal .btn{
  padding:8px 12px; border-radius:999px; border:1px solid #cbd5e1; background:#f8fafc
}
.modal .close{float:right}

/* Faith chips */
.chip{padding:6px 10px;border-radius:999px;border:1px solid #cbd5e1;background:#f8fafc}

/* Utilities */
.hide{display:none}
</style>
</head>

<body>
<div class="app">

  <div class="header">
    AURA-X Î©
    <small>Offline emotional continuity engine (prototype)</small>
  </div>

  <div class="hero">
    <div class="ethic">
      Universal ethic: avoid actions that grow negative emotions. Move gently toward choices that increase shared positive feeling.
    </div>
    <div class="engine">EMOTIONAL CONTINUITY ENGINE â€” ACTIVE</div>
    <button class="options-btn" onclick="openOptions()">âš™ Options</button>
  </div>

  <!-- One-line metrics -->
  <div class="metrics">
    <div class="metric"><b id="mE0">0.000</b><small>Eâ‚€</small></div>
    <div class="metric"><b id="mTM">0.00</b><small>TM</small></div>
    <div class="metric"><b id="mBM">0.00</b><small>BM</small></div>
    <div class="metric"><b id="mCI">0.000</b><small>Continuity</small></div>
  </div>

  <!-- BIG console -->
  <div class="console" id="console">
    <div class="line">AURA-X Î© console ready.</div>
  </div>

  <!-- Chat -->
  <div class="chat" id="chat"></div>

  <div class="input">
    <input id="inp" placeholder="Talk to AURA-X Î©â€¦ (TM = your inputs)"/>
    <button onclick="send()">Send</button>
  </div>

  <div class="formula">
    Eâ‚€ = tanh( R(TM,BM) + I(TM) + I<sub>intel</sub> + I<sub>LLM</sub> âˆ’ D + Î»<sub>faith</sub> + Î»<sub>sys</sub> + Î»<sub>trc</sub> )
  </div>
</div>

<!-- ===== Modals ===== -->
<div class="modal" id="options">
  <div class="card">
    <button class="close" onclick="closeOptions()">Close</button>
    <h3>AURA-X Î© options</h3>
    <p>Faith lens (optional)</p>
    <div class="row">
      <span class="chip" onclick="setFaith('None')">None</span>
      <span class="chip" onclick="setFaith('Islam')">Islam</span>
      <span class="chip" onclick="setFaith('Christianity')">Christianity</span>
      <span class="chip" onclick="setFaith('Hinduism')">Hinduism</span>
      <span class="chip" onclick="setFaith('Buddhism')">Buddhism</span>
    </div>
    <hr/>
    <button class="btn" onclick="openIntelligence()">ðŸ§  Intelligence</button>
    <button class="btn" onclick="openSeed()">ðŸŒ± Feed the seed</button>
    <button class="btn" onclick="openLLM()">ðŸ¤– LLM link</button>
    <button class="btn" onclick="toggleVoice()">ðŸ”Š Voice</button>
  </div>
</div>

<div class="modal" id="intel">
  <div class="card">
    <button class="close" onclick="closeIntel()">Close</button>
    <h3>Intelligence nodes</h3>
    <p>Self-learned Qâ†’A pairs (offline).</p>
    <div id="intelList" style="max-height:260px;overflow:auto"></div>
  </div>
</div>

<div class="modal" id="seed">
  <div class="card">
    <button class="close" onclick="closeSeed()">Close</button>
    <h3>Feed the seed (protected)</h3>
    <textarea id="seedText" style="width:100%;height:140px"></textarea>
    <div class="row">
      <button class="btn" onclick="saveSeed()">Save</button>
      <button class="btn" onclick="closeSeed()">Discard</button>
    </div>
  </div>
</div>

<div class="modal" id="llm">
  <div class="card">
    <button class="close" onclick="closeLLM()">Close</button>
    <h3>LLM link</h3>
    <p>Offline-first. Optional online key.</p>
    <button class="btn" onclick="toggleLLM()">Toggle LLM</button>
  </div>
</div>

<script>
/* =========================
   STATE (Code-X logic)
========================= */
const TM=[];                 // temporary memory
let BM=JSON.parse(localStorage.getItem('BM')||'[]');
const BM_MAX=30*24*60*60*1000; // 30 days
let faith='None';
let llmOn=false;
let voiceOn=false;

/* ===== helpers ===== */
const $=id=>document.getElementById(id);
function addMsg(t,cls){
  const d=document.createElement('div');
  d.className='msg '+cls; d.textContent=t;
  chat.appendChild(d); chat.scrollTop=chat.scrollHeight;
}
function log(t){
  const l=document.createElement('div');
  l.className='line'; l.textContent=t;
  console.appendChild(l); console.scrollTop=console.scrollHeight;
}

/* ===== BM rules ===== */
function maintainBM(){
  const now=Date.now();
  BM.forEach(b=>{ if(b.count>1) b.locked=true; });
  BM=BM.filter(b=>b.locked || (now-b.time)<BM_MAX);
  localStorage.setItem('BM',JSON.stringify(BM));
}

/* ===== Resonance ===== */
function R(){ return BM.length? TM.length/BM.length:0; }
function compute(){
  const I_TM=TM.length*0.2;
  const I_intel=0.3;
  const I_LLM=llmOn?0.4:0;
  const D=0.2, lf=0.2, ls=0.2, lt=0.2;
  const x=R()+I_TM+I_intel+I_LLM-D+lf+ls+lt;
  const E0=Math.tanh(x);
  // live metrics (animated-ish)
  mE0.textContent=E0.toFixed(3);
  mTM.textContent=I_TM.toFixed(2);
  mBM.textContent=(BM.length?0.01:0.00).toFixed(2);
  mCI.textContent=(0.85+Math.min(0.15,TM.length*0.01)).toFixed(3);
  return E0;
}

/* ===== Voice (fix) ===== */
function speak(text){
  if(!voiceOn || !('speechSynthesis' in window)) return;
  const u=new SpeechSynthesisUtterance(text);
  u.rate=1; u.pitch=1; u.lang='en-US';
  speechSynthesis.cancel(); speechSynthesis.speak(u);
}

/* ===== Send ===== */
function send(){
  const v=inp.value.trim(); if(!v) return;
  inp.value='';
  addMsg(v,'user'); TM.push(v);

  let b=BM.find(x=>x.text===v);
  if(b){ b.count++; b.locked=true; }
  else{ BM.push({text:v,time:Date.now(),count:1,locked:false}); }
  maintainBM();

  const E0=compute();
  let reply=E0>0.6?'Understood with high resonance.':
            E0>0.2?'Processing with emotional continuity.':
                   (llmOn?'Fallback to offline LLM.':'Stored locally.');
  addMsg(reply,'bot'); log(`Eâ‚€=${E0.toFixed(3)} | TM=${TM.length} | BM=${BM.length}`);
  speak(reply);
}

/* ===== Modals ===== */
function openOptions(){ options.style.display='flex'; }
function closeOptions(){ options.style.display='none'; }
function openIntelligence(){ intel.style.display='flex'; }
function closeIntel(){ intel.style.display='none'; }
function openSeed(){ seed.style.display='flex'; }
function closeSeed(){ seed.style.display='none'; }
function openLLM(){ llm.style.display='flex'; }
function closeLLM(){ llm.style.display='none'; }

/* ===== Actions ===== */
function setFaith(f){ faith=f; log('Faith lens: '+f); }
function toggleLLM(){ llmOn=!llmOn; log('LLM '+(llmOn?'ON':'OFF')); }
function toggleVoice(){ voiceOn=!voiceOn; log('Voice '+(voiceOn?'ON':'OFF')); }
function saveSeed(){ log('Seed saved.'); closeSeed(); }

/* init */
maintainBM(); compute();
</script>
</body>
</html>