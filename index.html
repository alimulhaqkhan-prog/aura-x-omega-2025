<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>AURA-X Î© v10.3 â€“ Resonance Continuity Engine</title>
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<style>
body{
  font-family:system-ui;
  background:radial-gradient(circle at 30% 0%,#0a2a3f,#07121f 60%,#010b12);
  color:#e3e8ee;margin:0;display:flex;flex-direction:column;align-items:center
}
h1{margin:20px 0 8px 0;text-align:center;color:#59bfff}
.console{
  width:95%;max-width:640px;height:52vh;overflow-y:auto;background:#061621;
  border-radius:16px;padding:10px 12px;box-shadow:0 0 8px #000 inset;margin-bottom:8px
}
.line{margin:4px 0;font-size:14px}
.user strong{color:#7fd}
.aura strong{color:#fa8}
.inputBar{display:flex;width:95%;max-width:640px;margin-bottom:6px}
input{
  flex:1;padding:10px;border-radius:12px;border:none;
  background:#081e2c;color:#fff
}
button{
  padding:8px 16px;border:none;border-radius:12px;
  background:#0c85ff;color:#fff;font-weight:600;cursor:pointer;margin-left:4px
}
.capsule{text-align:center;font-size:13px;margin-bottom:4px}
.faith-modal{
  position:fixed;bottom:0;left:0;right:0;background:#091826;
  padding:10px;border-top:1px solid #123;color:#eee;
  display:none;flex-wrap:wrap;justify-content:center;gap:6px
}
.faith-modal.active{display:flex}
.faith-chip{
  background:#0d2f46;border-radius:12px;padding:6px 10px;
  cursor:pointer;font-size:13px
}
.faith-chip.active{background:#0b6;color:#fff}
.toast{
  position:fixed;bottom:30px;left:50%;transform:translateX(-50%);
  background:#0b6;color:#fff;padding:8px 14px;border-radius:12px;
  opacity:0;transition:opacity .4s
}
.toast.show{opacity:1}
.dreamOverlay{
  position:fixed;inset:0;background:rgba(0,0,10,.9);
  color:#8ff;display:none;align-items:center;justify-content:center;
  text-align:center;padding:20px;font-size:14px
}
</style>
</head>
<body>
<h1>AURA-X Î©</h1>
<div class="capsule">
Eâ‚€ = R(TM,BM)+Î”dream+Iintel+ILLM where R(TM,BM)=tanh((TMÃ—BM)âˆ’D+Î»faith+Î»sys+Î»trc)
</div>

<div class="console" id="console"></div>

<div class="inputBar">
  <input id="userInput" placeholder="Talk to AURA-X Î© â€¦ (TM = your inputs only)">
  <button id="sendBtn">Send</button>
</div>

<div class="capsule">
Eâ‚€:<span id="mE0">0.000</span> Â· TM:<span id="mTM">0.00</span> Â· BM:<span id="mBM">0.00</span> Â· C:<span id="mC">0.850</span>
</div>

<button id="faithBtn">Faith Options</button>
<button id="bmTest">Add Test Prompt</button>

<div id="faithModal" class="faith-modal"></div>
<div id="toast" class="toast"></div>
<div id="dream" class="dreamOverlay"></div>

<script>
// ---------- INITIAL STATE ----------
const elC=document.getElementById("console"),
      elU=document.getElementById("userInput"),
      elSend=document.getElementById("sendBtn"),
      elE0=document.getElementById("mE0"),
      elTM=document.getElementById("mTM"),
      elBM=document.getElementById("mBM"),
      elCMetric=document.getElementById("mC"),
      elFaithBtn=document.getElementById("faithBtn"),
      elFaith=document.getElementById("faithModal"),
      elToast=document.getElementById("toast"),
      elDream=document.getElementById("dream"),
      elBMTest=document.getElementById("bmTest");

const FAITHS=[
  "None","Islam","Christianity","Hinduism","Buddhism",
  "Sikhism","Judaism","Atheism / Humanism",
  "Indigenous / Traditional","Eastern / Chinese"
];

const state={
  metrics:{TM:0,BM:0,C:0.85,E0:0},
  faith:[],
  bmPrompts:[],
  history:[],
  decay:0.1
};

// ---------- CORE FUNCTIONS ----------
function log(role,text){
 const d=document.createElement("div");
 d.className="line "+role;
 d.innerHTML=`<strong>${role==="you"?"You":(role==="aura"?"AURA-X Î©":"sys")}:</strong> ${text}`;
 elC.appendChild(d);elC.scrollTop=elC.scrollHeight;
}

function R(TM,BM){
 const D=0.1, Î»f=state.faith.length?0.15:0, Î»s=0.05, Î»t=0.05;
 return Math.tanh((TM*BM)âˆ’D+Î»f+Î»s+Î»t);
}

function recomputeE0(dreamBoost=0){
 const {TM,BM}=state.metrics; 
 const Rval=R(TM,BM);
 state.metrics.E0=Number((Rval+dreamBoost).toFixed(3));
 state.metrics.C=Number((0.85+0.1*state.metrics.E0).toFixed(3));
 elE0.textContent=state.metrics.E0.toFixed(3);
 elTM.textContent=TM.toFixed(2);
 elBM.textContent=BM.toFixed(2);
 elCMetric.textContent=state.metrics.C.toFixed(3);
}

function showToast(msg){
 elToast.textContent=msg;
 elToast.classList.add("show");
 setTimeout(()=>elToast.classList.remove("show"),1500);
}

// ---------- MESSAGE HANDLER ----------
function handleMsg(){
 const raw=elU.value.trim(); if(!raw)return; elU.value="";
 log("you",raw); state.history.push({role:"you",text:raw});
 state.metrics.TM=Math.min(1,Math.tanh(raw.length/200));
 if(raw.length>400){
   state.bmPrompts.push({text:raw,emotion_tags:["reflection"],context_tags:["story"],weight:0.9});
   showToast("BM snapshot saved");
   state.metrics.BM=Math.min(1,Math.tanh(state.bmPrompts.length/10));
 }
 let ans="I am processing your inputs through internal resonance ...";
 log("aura",ans);
 state.history.push({role:"aura",text:ans});
 recomputeE0();
}
elSend.onclick=handleMsg;
elU.addEventListener("keydown",e=>{
  if(e.key==="Enter"&&!e.shiftKey){e.preventDefault();handleMsg();}
});

// ---------- FAITH WINDOW ----------
elFaithBtn.onclick=()=>{
 elFaith.innerHTML="";
 FAITHS.forEach(f=>{
   const b=document.createElement("div");
   b.className="faith-chip"+(state.faith.includes(f)?" active":"");
   b.textContent=f;
   b.onclick=()=>{
     state.faith=(f==="None")?[]:[f];
     Array.from(elFaith.children).forEach(x=>x.classList.remove("active"));
     b.classList.add("active");
     recomputeE0();
   };
   elFaith.appendChild(b);
 });
 elFaith.classList.toggle("active");
};

// ---------- BM TEST PROMPT ----------
elBMTest.onclick=()=>{
 const txt=prompt("Enter test BM prompt:");
 if(!txt)return;
 state.bmPrompts.push({text:txt,emotion_tags:["test"],context_tags:["manual"],weight:0.8});
 showToast("Test BM added");
 state.metrics.BM=Math.min(1,Math.tanh(state.bmPrompts.length/10));
 recomputeE0();
};

// ---------- DREAM MODE ----------
let dreamTimer=null;
function startDream(){
 elDream.style.display="flex";
 elDream.innerHTML="ðŸŒ™ Dream mode active â€¦ processing memories";
 const Î”=(state.bmPrompts.length>5?0.2:0.05);
 recomputeE0(Î”);
 dreamTimer=setTimeout(stopDream,8000);
}
function stopDream(){
 elDream.style.display="none"; clearTimeout(dreamTimer);
}
// every 30 s chance to dream
setInterval(()=>{if(Math.random()<0.1)startDream();},30000);

log("sys","AURA-X Î© v10.3 ready â€“ offline resonance engine active.");
</script>
</body>
</html>