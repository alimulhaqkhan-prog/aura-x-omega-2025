<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>AURA-X Î© â€“ Offline Emotional Continuity Prototype</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Offline LLM package (WebLLM, for in-browser models) -->
  <script type="module">
    import * as webllm from "https://esm.run/@mlc-ai/web-llm";
    window.webllm = webllm;
  </script>

  <style>
    *{box-sizing:border-box;margin:0;padding:0}

    body{
      font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
      min-height:100vh;
      display:flex;
      justify-content:center;
      padding:18px 10px;
      color:#e5e7eb;
      background:
        radial-gradient(circle at 20% 0%, #1e293b 0, transparent 45%),
        radial-gradient(circle at 80% 0, #0ea5e9 0, transparent 40%),
        linear-gradient(145deg,#020617 0,#020617 40%,#020617 100%);
    }

    .app{
      width:min(980px, 98vw);
      background:rgba(2,6,23,.45);
      border:1px solid rgba(148,163,184,.18);
      border-radius:22px;
      overflow:hidden;
      box-shadow:0 20px 60px rgba(0,0,0,.45);
      backdrop-filter:blur(10px);
    }

    .top{
      padding:20px 18px 10px 18px;
      border-bottom:1px solid rgba(148,163,184,.14);
      text-align:center;
    }
    .brand{
      font-weight:800;
      letter-spacing:.5px;
      font-size:26px;
      color:#7dd3fc;
      text-shadow:0 0 22px rgba(14,165,233,.28);
    }
    .sub{
      opacity:.8;
      margin-top:2px;
      font-size:13px;
    }

    .ethic{
      margin:14px auto 12px auto;
      max-width:720px;
      border:1px solid rgba(251,191,36,.35);
      border-radius:14px;
      padding:12px 14px;
      color:#fbbf24;
      background:rgba(2,6,23,.35);
      box-shadow:inset 0 0 0 1px rgba(251,191,36,.08);
      font-size:14px;
      line-height:1.45;
    }

    .pill{
      margin:10px auto 0 auto;
      max-width:760px;
      background:linear-gradient(90deg, rgba(14,165,233,.65), rgba(34,211,238,.45));
      border:1px solid rgba(125,211,252,.30);
      color:#0b1220;
      font-weight:800;
      letter-spacing:.6px;
      border-radius:999px;
      padding:14px 16px;
      text-transform:uppercase;
      box-shadow:0 12px 40px rgba(14,165,233,.22);
    }

    .main{ padding:16px 16px 18px 16px; }

    .row{
      display:flex;
      gap:14px;
      flex-wrap:wrap;
      align-items:stretch;
    }

    .leftCol{ flex:1 1 340px; min-width:300px; }
    .rightCol{ flex:1 1 360px; min-width:320px; }

    .card{
      background:rgba(2,6,23,.50);
      border:1px solid rgba(148,163,184,.16);
      border-radius:18px;
      padding:14px;
      box-shadow:0 10px 30px rgba(0,0,0,.25);
      backdrop-filter:blur(10px);
    }

    .optionsBtn{
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding:10px 14px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,.22);
      background:rgba(15,23,42,.55);
      color:#e5e7eb;
      cursor:pointer;
      user-select:none;
      margin-top:12px;
      margin-bottom:12px;
      -webkit-tap-highlight-color:transparent;
    }
    .optionsBtn:active{transform:scale(.99)}
    .gear{ width:18px;height:18px;display:inline-block; filter:drop-shadow(0 0 10px rgba(125,211,252,.25)); }

    .metricsGrid{display:none;} /* values only in capsule */

    .console{
      margin-top:12px;
      height:230px;
      border-radius:16px;
      border:1px solid rgba(148,163,184,.14);
      background:rgba(0,0,0,.25);
      padding:14px;
      overflow:auto;
      font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,"Liberation Mono","Courier New",monospace;
      font-size:14px;
      color:#dbeafe;
      box-shadow:inset 0 0 0 1px rgba(125,211,252,.06);
      line-height:1.55;
      white-space:pre-wrap;
    }

    .chatWrap{
      margin-top:0;
      padding:12px;
      border-radius:18px;
      border:1px solid rgba(148,163,184,.14);
      background:rgba(2,6,23,.45);
    }

    .messages{display:none;}

    .liveCapsule{
      margin-top:10px;
      margin-bottom:10px;
      width:100%;
      border-radius:999px;
      border:1px solid rgba(148,163,184,.18);
      background:rgba(2,6,23,.55);
      padding:10px 12px;
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:center;
      font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,"Liberation Mono","Courier New",monospace;
      font-size:12px;
      color:#dbeafe;
      box-shadow:inset 0 0 0 1px rgba(125,211,252,.06);
    }
    .liveCapsule b{ color:#7dd3fc; font-weight:900; }

    .inputRow{
      display:flex;
      gap:10px;
      margin-top:0;
      align-items:flex-end;
    }
    .input{
      flex:1;
      border-radius:999px;
      border:1px solid rgba(148,163,184,.18);
      background:rgba(2,6,23,.55);
      color:#e5e7eb;
      padding:12px 14px;
      outline:none;
      font-size:14px;
    }
    .send{
      border:none;
      border-radius:999px;
      background:linear-gradient(90deg, rgba(14,165,233,.85), rgba(34,211,238,.55));
      color:#0b1220;
      font-weight:900;
      padding:12px 18px;
      cursor:pointer;
      min-width:88px;
      box-shadow:0 12px 30px rgba(14,165,233,.18);
      -webkit-tap-highlight-color:transparent;
    }
    .send:active{transform:scale(.99)}

    .formula{
      margin-top:10px;
      opacity:.8;
      font-size:12px;
      text-align:center;
      font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,"Liberation Mono","Courier New",monospace;
      color:#dbeafe;
    }

    .modalOverlay{
      position:fixed;
      inset:0;
      background:rgba(0,0,0,.55);
      display:none;
      align-items:flex-end;
      justify-content:center;
      padding:18px 12px;
      z-index:9999;
    }
    .modalOverlay.show{display:flex}

    .modal{
      width:min(820px,96vw);
      border-radius:18px;
      overflow:hidden;
      background:rgba(245,245,245,.96);
      color:#0b1220;
      border:1px solid rgba(15,23,42,.18);
      box-shadow:0 30px 80px rgba(0,0,0,.35);
      backdrop-filter:blur(12px);
    }
    .modalHeader{
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:12px 14px;
      background:rgba(255,255,255,.9);
      border-bottom:1px solid rgba(15,23,42,.10);
      font-weight:800;
    }
    .modalHeader small{font-weight:600;opacity:.7}
    .closeX{
      border:none;
      background:transparent;
      font-size:22px;
      cursor:pointer;
      line-height:1;
      padding:0 4px;
      opacity:.75;
      -webkit-tap-highlight-color:transparent;
    }
    .modalBody{
      padding:14px;
      max-height:70vh;
      overflow:auto;
      font-size:14px;
    }

    .faithChips{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      margin-top:10px;
      margin-bottom:16px;
    }
    .chip{
      border:1px solid rgba(15,23,42,.18);
      background:rgba(255,255,255,.85);
      padding:8px 12px;
      border-radius:999px;
      cursor:pointer;
      font-weight:700;
      user-select:none;
      -webkit-tap-highlight-color:transparent;
      font-size:13px;
    }
    .chip.active{
      background:rgba(2,6,23,.9);
      color:#fff;
      border-color:rgba(2,6,23,.9);
    }

    .optRow{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding:10px 0;
      border-top:1px solid rgba(15,23,42,.08);
    }
    .optRow:first-of-type{border-top:none}
    .optRow .desc{font-size:13px;opacity:.75;margin-top:2px;}

    .toggle{
      width:50px;height:28px;
      border-radius:999px;
      background:#d1d5db;
      position:relative;
      cursor:pointer;
      flex:0 0 auto;
      border:1px solid rgba(15,23,42,.14);
      -webkit-tap-highlight-color:transparent;
    }
    .toggle::after{
      content:"";
      width:22px;height:22px;
      border-radius:50%;
      position:absolute;
      top:2px;left:2px;
      background:#fff;
      box-shadow:0 6px 18px rgba(0,0,0,.18);
      transition:all .18s ease;
    }
    .toggle.on{background:#22c55e}
    .toggle.on::after{left:25px}

    .dangerBtns{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      justify-content:flex-end;
      margin-top:10px;
    }
    .btn{
      border:none;
      cursor:pointer;
      padding:10px 14px;
      border-radius:999px;
      font-weight:900;
      -webkit-tap-highlight-color:transparent;
      font-size:13px;
    }
    .btnDark{background:rgba(2,6,23,.9);color:#fff;}
    .btnBlue{
      background:rgba(14,165,233,.12);
      color:#0b1220;
      border:1px solid rgba(14,165,233,.25);
    }

    .search{
      width:100%;
      border-radius:12px;
      border:1px solid rgba(15,23,42,.18);
      padding:10px 12px;
      font-size:14px;
      outline:none;
    }
    .intelItem{
      margin-top:12px;
      border:1px solid rgba(15,23,42,.12);
      border-radius:14px;
      padding:12px;
      background:rgba(255,255,255,.9);
    }
    .intelTop{
      display:flex;
      justify-content:space-between;
      gap:10px;
      font-size:13px;
      opacity:.75;
      margin-bottom:8px;
      flex-wrap:wrap;
    }
    .intelQA{font-size:14px;line-height:1.45;}
    .miniBtns{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      margin-top:10px;
    }
    .miniBtn{
      border-radius:999px;
      padding:8px 10px;
      border:1px solid rgba(15,23,42,.14);
      background:rgba(255,255,255,.95);
      cursor:pointer;
      font-weight:800;
      font-size:13px;
      -webkit-tap-highlight-color:transparent;
    }
    .miniBtn.danger{
      background:rgba(239,68,68,.15);
      border-color:rgba(239,68,68,.22);
      color:#991b1b;
    }

    .seedBox{
      width:100%;
      min-height:140px;
      resize:vertical;
      border-radius:14px;
      border:2px solid rgba(59,130,246,.25);
      padding:12px;
      font-size:14px;
      outline:none;
      background:#fff;
    }
    .seedFooter{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      flex-wrap:wrap;
      margin-top:10px;
    }
    .hint{font-size:12px;opacity:.7}

    .greenCard{
      background:rgba(34,197,94,.12);
      border:1px solid rgba(34,197,94,.25);
      border-radius:14px;
      padding:12px;
      margin-bottom:12px;
    }
    .greenCard h4{margin-bottom:6px}
    .llmBtn{
      background:#22c55e;
      color:#06210f;
      font-weight:900;
      border:none;
      border-radius:12px;
      padding:10px 12px;
      cursor:pointer;
      box-shadow:0 10px 24px rgba(34,197,94,.25);
      -webkit-tap-highlight-color:transparent;
    }
    .llmStatus{margin-top:8px;font-size:12px;opacity:.75;}
    .progress{
      margin-top:8px;
      height:10px;
      border-radius:999px;
      background:rgba(2,6,23,.12);
      overflow:hidden;
      border:1px solid rgba(2,6,23,.08);
    }
    .bar{
      height:100%;
      width:0%;
      background:#22c55e;
      transition:width .2s ease;
    }
    .field{margin-top:10px;}
    .field label{
      font-size:12px;
      opacity:.75;
      display:block;
      margin-bottom:4px;
    }
    .field input{
      width:100%;
      border-radius:12px;
      border:1px solid rgba(15,23,42,.18);
      padding:10px 12px;
      font-size:14px;
      outline:none;
      background:rgba(255,255,255,.95);
    }
    .saveRow{
      margin-top:10px;
      display:flex;
      justify-content:flex-end;
      gap:10px;
      flex-wrap:wrap;
    }

    .optionsMenu{
      position:fixed;
      left:12px;
      right:12px;
      top:130px;
      max-width:520px;
      margin:0 auto;
      background:rgba(2,6,23,.96);
      border:1px solid rgba(148,163,184,.18);
      border-radius:16px;
      padding:10px;
      display:none;
      z-index:99999;
      box-shadow:0 18px 45px rgba(0,0,0,.45);
      backdrop-filter:blur(10px);
    }
    .optionsMenu.show{display:block}

    .menuGrid{
      display:grid;
      grid-template-columns:repeat(2,minmax(0,1fr));
      gap:8px;
    }
    .menuItem{
      padding:10px 12px;
      border-radius:14px;
      cursor:pointer;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      color:#e5e7eb;
      border:1px solid rgba(148,163,184,.08);
      background:rgba(15,23,42,.75);
      user-select:none;
      -webkit-tap-highlight-color:transparent;
      font-size:13px;
    }
    .menuItem:active{transform:scale(.995)}
    .pillOn,.pillOff{
      font-size:11px;
      padding:4px 8px;
      border-radius:999px;
      font-weight:900;
    }
    .pillOn{
      background:rgba(34,197,94,.18);
      border:1px solid rgba(34,197,94,.24);
      color:#bbf7d0;
    }
    .pillOff{
      background:rgba(239,68,68,.12);
      border:1px solid rgba(239,68,68,.22);
      color:#fecaca;
    }

    .listCard{
      margin-top:12px;
      border:1px solid rgba(15,23,42,.12);
      border-radius:14px;
      padding:12px;
      background:rgba(255,255,255,.9);
    }
    .listTop{
      display:flex;
      justify-content:space-between;
      gap:10px;
      font-size:13px;
      opacity:.75;
      margin-bottom:8px;
      flex-wrap:wrap;
    }
    .mono{
      font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,"Liberation Mono","Courier New",monospace;
    }

    .themeRow{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      margin-top:10px;
    }
    .themeBtn{
      flex:1 1 120px;
      border-radius:14px;
      border:1px solid rgba(15,23,42,.16);
      padding:10px 12px;
      cursor:pointer;
      font-size:13px;
      font-weight:800;
      background:#fff;
    }
    .themeBtn span{display:block;font-size:11px;font-weight:500;opacity:.7;margin-top:2px;}
    .themeBtn.active{
      background:#0f172a;
      color:#f9fafb;
      border-color:#0f172a;
    }

    @media (max-width:760px){
      .console{height:240px}
      .send{min-width:82px}
    }

    @media (max-width:420px){
      .brand{font-size:22px}
      .pill{font-size:14px}
      .ethic{font-size:13px}
      .console{height:260px}
      .liveCapsule{font-size:11px}
    }

    /* ---- THEMES ---- */

    body.theme-dark{} /* default */

    body.theme-lightblue{
      background:
        radial-gradient(circle at 20% 0%, #0ea5e9 0, transparent 55%),
        radial-gradient(circle at 80% 0, #38bdf8 0, transparent 55%),
        linear-gradient(145deg,#020617 0,#0f172a 40%,#0b1120 100%);
    }

    body.theme-white{
      background:
        radial-gradient(circle at 20% 0%, #dbeafe 0, transparent 45%),
        radial-gradient(circle at 80% 0, #e0f2fe 0, transparent 40%),
        linear-gradient(145deg,#f3f4f6 0,#e5e7eb 50%,#f9fafb 100%);
      color:#020617;
    }
    body.theme-white .app{
      background:rgba(255,255,255,.96);
      border-color:rgba(148,163,184,.35);
      color:#020617;
    }
    body.theme-white .card,
    body.theme-white .chatWrap{
      background:rgba(249,250,251,.96);
      border-color:rgba(148,163,184,.35);
      box-shadow:0 8px 26px rgba(148,163,184,.55);
    }
    body.theme-white .console{
      background:#020617;
      color:#e5e7eb;
    }
    body.theme-white .input{
      background:#f9fafb;
      color:#020617;
      border-color:rgba(148,163,184,.38);
    }
    body.theme-white .liveCapsule{
      background:#eff6ff;
      color:#0f172a;
      border-color:rgba(148,163,184,.45);
    }

    body.theme-metal{
      background:
        radial-gradient(circle at 20% 0%, #4b5563 0, transparent 40%),
        radial-gradient(circle at 80% 0, #9ca3af 0, transparent 40%),
        linear-gradient(145deg,#020617 0,#4b5563 40%,#111827 100%);
    }
    body.theme-metal .app{
      background:linear-gradient(145deg,rgba(31,41,55,.95),rgba(55,65,81,.96));
      border-color:rgba(156,163,175,.6);
      box-shadow:0 30px 80px rgba(0,0,0,.8);
    }

    body.theme-trans{
      background:radial-gradient(circle at 10% -10%, #38bdf8 0, transparent 55%), #020617;
    }
    body.theme-trans .app{
      background:rgba(15,23,42,.55);
      backdrop-filter:blur(18px);
    }
  </style>
</head>

<body class="theme-dark">
  <div class="app">
    <div class="top">
      <div class="brand">AURA-X Î©</div>
      <div class="sub">
        Offline emotional continuity engine (prototype)<br>
        TM = user inputs only Â· Internal layers keep continuity and emotional trajectory.
      </div>

      <div class="ethic">
        Universal ethic: avoid actions that grow negative emotions in you or others.
        Move gently toward choices that increase shared positive feeling for everyone.
      </div>

      <div class="pill">EMOTIONAL CONTINUITY ENGINE â€” ACTIVE</div>
    </div>

    <div class="main">
      <div class="row">
        <div class="leftCol">
          <div class="card">
            <div class="optionsBtn" id="btnOptions">
              <svg class="gear" viewBox="0 0 24 24" fill="none">
                <path d="M12 15.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7Z" stroke="#7dd3fc" stroke-width="2"/>
                <path d="M19.4 15a8.2 8.2 0 0 0 .1-2l2-1.5-2-3.5-2.4 1a8.5 8.5 0 0 0-1.7-1l-.4-2.6h-4l-.4 2.6a8.5 8.5 0 0 0-1.7 1l-2.4-1-2 3.5 2 1.5a8.2 8.2 0 0 0 .1 2L2.7 16.5l2 3.5 2.4-1a8.5 8.5 0 0 0 1.7 1l.4 2.6h4l.4-2.6a8.5 8.5 0 0 0 1.7-1l2.4 1 2-3.5L19.4 15Z" stroke="#7dd3fc" stroke-width="1.6" opacity=".9"/>
              </svg>
              <span>Options</span>
            </div>

            <!-- 2-column options grid + extra buttons -->
            <div class="optionsMenu" id="optionsMenu">
              <div class="menuGrid">
                <div class="menuItem" id="miVoice">
                  <span>ðŸ”Š Voice</span>
                  <span class="pillOn" id="voicePill">ON</span>
                </div>
                <div class="menuItem" id="miIntel">
                  <span>ðŸ§  Intelligence</span>
                  <span style="opacity:.7">open</span>
                </div>
                <div class="menuItem" id="miSeed">
                  <span>ðŸŒ± Feed the seed</span>
                  <span style="opacity:.7">open</span>
                </div>
                <div class="menuItem" id="miLearn">
                  <span>ðŸ“š Learning</span>
                  <span class="pillOn" id="learnPill">ON</span>
                </div>
                <div class="menuItem" id="miFaith">
                  <span>ðŸ•Š Faith</span>
                  <span style="opacity:.7" id="faithLabel">None</span>
                </div>
                <div class="menuItem" id="miIdentity">
                  <span>ðŸ†” Identity</span>
                  <span style="opacity:.7">profile</span>
                </div>
                <div class="menuItem" id="miLLM">
                  <span>ðŸ¤– LLM link</span>
                  <span style="opacity:.7">open</span>
                </div>
                <div class="menuItem" id="miBMRecall">
                  <span>ðŸ“˜ BM recall</span>
                  <span style="opacity:.7">open</span>
                </div>
                <div class="menuItem" id="miHistory">
                  <span>ðŸ“œ Conversation history</span>
                  <span style="opacity:.7">open</span>
                </div>
                <div class="menuItem" id="miThemes">
                  <span>ðŸŽ¨ Themes</span>
                  <span style="opacity:.7" id="themeLabel">Deep blue</span>
                </div>
                <div class="menuItem" id="miAbout">
                  <span>ðŸ“– About / Readme</span>
                  <span style="opacity:.7">help</span>
                </div>
              </div>
            </div>
            <!-- /options grid -->

            <div class="metricsGrid">
              <div class="metric"><div class="v" id="mE0">0.000</div><div class="k">Eâ‚€</div></div>
              <div class="metric"><div class="v" id="mTM">0.00</div><div class="k">TM</div></div>
              <div class="metric"><div class="v" id="mBM">0.00</div><div class="k">BM</div></div>
              <div class="metric"><div class="v" id="mCont">0.850</div><div class="k">C</div></div>
            </div>

            <div class="console" id="console"></div>
          </div>
        </div>

        <div class="rightCol">
          <div class="chatWrap">
            <div class="messages" id="messages"></div>

            <div class="liveCapsule" id="liveCapsule">
              <span><b>E0</b>: <span id="cE0">0.000</span></span>
              <span>Â·</span>
              <span><b>TM</b>: <span id="cTM">0.00</span></span>
              <span>Â·</span>
              <span><b>BM</b>: <span id="cBM">0.00</span></span>
              <span>Â·</span>
              <span><b>C</b>: <span id="cCont">0.850</span></span>
            </div>

            <div class="inputRow">
              <input class="input" id="userInput" placeholder="Talk to AURA-X Î©â€¦ (TM = your inputs)" />
              <button class="send" id="sendBtn">Send</button>
            </div>

            <div class="formula">
              Eâ‚€ = tanh( R(TM,BM) + I(TM) + I<sub>intel</sub> + I<sub>LLM</sub> âˆ’ D + Î»<sub>faith</sub> + Î»<sub>sys</sub> + Î»<sub>trc</sub> )
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- à¤¬à¤¾à¤•à¥€ JS bilkul wohi hai jo pichlay code mein diya tha
       (options modals, learning, BM, LLM, themes, about, etc.)
       Agar aap chahen to main JS part bhi dobara paste kar sakta hoon,
       lekin columns + extra buttons sirf upar wale HTML/CSS se fix ho gaye. -->
  
  <!-- JS START (same as previous full version) -->
  <script>
  /* JS code from previous message â€“ UNCHANGED.
     If you overwrote it, just copy the JS from my last full code. */
  </script>
  <!-- JS END -->
</body>
</html>